module.exports = [
"[project]/node_modules/better-auth/dist/index.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

return __turbopack_context__.a(async (__turbopack_handle_async_dependencies__, __turbopack_async_result__) => { try {

__turbopack_context__.s([
    "BetterAuthError",
    ()=>O,
    "HIDE_METADATA",
    ()=>N,
    "MissingDependencyError",
    ()=>De,
    "betterAuth",
    ()=>rc,
    "capitalizeFirstLetter",
    ()=>En,
    "createCookieGetter",
    ()=>qe,
    "createLogger",
    ()=>de,
    "deleteSessionCookie",
    ()=>G,
    "generateId",
    ()=>E,
    "generateState",
    ()=>Be,
    "getCookies",
    ()=>Ne,
    "logger",
    ()=>b,
    "parseCookies",
    ()=>So,
    "parseSetCookieHeader",
    ()=>Po,
    "parseState",
    ()=>ae,
    "setSessionCookie",
    ()=>_
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/better-call/dist/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__ = __turbopack_context__.i("[project]/node_modules/zod/v3/external.js [app-route] (ecmascript) <export * as z>");
var __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$crypto__$5b$external$5d$__$28$oslo$2f$crypto$2c$__esm_import$29$__ = __turbopack_context__.i("[externals]/oslo/crypto [external] (oslo/crypto, esm_import)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$uncrypto$2f$dist$2f$crypto$2e$node$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/uncrypto/dist/crypto.node.mjs [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$encoding__$5b$external$5d$__$28$oslo$2f$encoding$2c$__esm_import$29$__ = __turbopack_context__.i("[externals]/oslo/encoding [external] (oslo/encoding, esm_import)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$noble$2f$hashes$2f$esm$2f$scrypt$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@noble/hashes/esm/scrypt.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$oauth2__$5b$external$5d$__$28$oslo$2f$oauth2$2c$__esm_import$29$__ = __turbopack_context__.i("[externals]/oslo/oauth2 [external] (oslo/oauth2, esm_import)");
var __TURBOPACK__imported__module__$5b$externals$5d2f$oslo__$5b$external$5d$__$28$oslo$2c$__esm_import$29$__ = __turbopack_context__.i("[externals]/oslo [external] (oslo, esm_import)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$std$2d$env$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/std-env/dist/index.mjs [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$consola$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/consola/dist/index.mjs [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$jwt__$5b$external$5d$__$28$oslo$2f$jwt$2c$__esm_import$29$__ = __turbopack_context__.i("[externals]/oslo/jwt [external] (oslo/jwt, esm_import)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$better$2d$fetch$2f$fetch$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@better-fetch/fetch/dist/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$nanoid$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/nanoid/index.js [app-route] (ecmascript) <locals>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$kysely$2f$dist$2f$esm$2f$kysely$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/kysely/dist/esm/kysely.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$kysely$2f$dist$2f$esm$2f$dialect$2f$mssql$2f$mssql$2d$dialect$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/kysely/dist/esm/dialect/mssql/mssql-dialect.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$kysely$2f$dist$2f$esm$2f$dialect$2f$mysql$2f$mysql$2d$dialect$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/kysely/dist/esm/dialect/mysql/mysql-dialect.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$kysely$2f$dist$2f$esm$2f$dialect$2f$postgres$2f$postgres$2d$dialect$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/kysely/dist/esm/dialect/postgres/postgres-dialect.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$kysely$2f$dist$2f$esm$2f$dialect$2f$sqlite$2f$sqlite$2d$dialect$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/kysely/dist/esm/dialect/sqlite/sqlite-dialect.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$defu$2f$dist$2f$defu$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/defu/dist/defu.mjs [app-route] (ecmascript)");
var __turbopack_async_dependencies__ = __turbopack_handle_async_dependencies__([
    __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$crypto__$5b$external$5d$__$28$oslo$2f$crypto$2c$__esm_import$29$__,
    __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$encoding__$5b$external$5d$__$28$oslo$2f$encoding$2c$__esm_import$29$__,
    __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$oauth2__$5b$external$5d$__$28$oslo$2f$oauth2$2c$__esm_import$29$__,
    __TURBOPACK__imported__module__$5b$externals$5d2f$oslo__$5b$external$5d$__$28$oslo$2c$__esm_import$29$__,
    __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$jwt__$5b$external$5d$__$28$oslo$2f$jwt$2c$__esm_import$29$__
]);
[__TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$crypto__$5b$external$5d$__$28$oslo$2f$crypto$2c$__esm_import$29$__, __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$encoding__$5b$external$5d$__$28$oslo$2f$encoding$2c$__esm_import$29$__, __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$oauth2__$5b$external$5d$__$28$oslo$2f$oauth2$2c$__esm_import$29$__, __TURBOPACK__imported__module__$5b$externals$5d2f$oslo__$5b$external$5d$__$28$oslo$2c$__esm_import$29$__, __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$jwt__$5b$external$5d$__$28$oslo$2f$jwt$2c$__esm_import$29$__] = __turbopack_async_dependencies__.then ? (await __turbopack_async_dependencies__)() : __turbopack_async_dependencies__;
;
;
;
;
;
;
;
;
function X(e, t) {
    let r = new Uint8Array(e), o = new Uint8Array(t);
    if (r.length !== o.length) return !1;
    let i = 0;
    for(let n = 0; n < r.length; n++)i |= r[n] ^ o[n];
    return i === 0;
}
;
;
;
var j = {
    N: 16384,
    r: 16,
    p: 1,
    dkLen: 64
};
async function Ae(e, t) {
    return await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$noble$2f$hashes$2f$esm$2f$scrypt$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["scryptAsync"])(e.normalize("NFKC"), t, {
        N: j.N,
        p: j.p,
        r: j.r,
        dkLen: j.dkLen,
        maxmem: 128 * j.N * j.r * 2
    });
}
var ke = async (e)=>{
    let t = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$encoding__$5b$external$5d$__$28$oslo$2f$encoding$2c$__esm_import$29$__["encodeHex"])((0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$uncrypto$2f$dist$2f$crypto$2e$node$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["getRandomValues"])(new Uint8Array(16))), r = await Ae(e, t);
    return `${t}:${(0, __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$encoding__$5b$external$5d$__$28$oslo$2f$encoding$2c$__esm_import$29$__["encodeHex"])(r)}`;
}, Re = async (e, t)=>{
    let [r, o] = e.split(":"), i = await Ae(t, r);
    return X(i, (0, __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$encoding__$5b$external$5d$__$28$oslo$2f$encoding$2c$__esm_import$29$__["decodeHex"])(o));
};
;
function Kt(e) {
    return e.toString(2).padStart(8, "0");
}
function Zt(e) {
    return [
        ...e
    ].map((t)=>Kt(t)).join("");
}
function Ue(e) {
    return parseInt(Zt(e), 2);
}
function Gt(e) {
    if (e < 0 || !Number.isInteger(e)) throw new Error("Argument 'max' must be an integer greater than or equal to 0");
    let t = (e - 1).toString(2).length, r = t % 8, o = new Uint8Array(Math.ceil(t / 8));
    __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$uncrypto$2f$dist$2f$crypto$2e$node$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].getRandomValues(o), r !== 0 && (o[0] &= (1 << r) - 1);
    let i = Ue(o);
    for(; i >= e;)__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$uncrypto$2f$dist$2f$crypto$2e$node$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].getRandomValues(o), r !== 0 && (o[0] &= (1 << r) - 1), i = Ue(o);
    return i;
}
function Te(e, t) {
    let r = "";
    for(let o = 0; o < e; o++)r += t[Gt(t.length)];
    return r;
}
function ve(...e) {
    let t = new Set(e), r = "";
    for (let o of t)o === "a-z" ? r += "abcdefghijklmnopqrstuvwxyz" : o === "A-Z" ? r += "ABCDEFGHIJKLMNOPQRSTUVWXYZ" : o === "0-9" ? r += "0123456789" : r += o;
    return r;
}
async function ee(e, t) {
    let r = new TextEncoder, o = {
        name: "HMAC",
        hash: "SHA-256"
    }, i = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$uncrypto$2f$dist$2f$crypto$2e$node$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].subtle.importKey("raw", r.encode(e), o, !1, [
        "sign",
        "verify"
    ]), n = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$uncrypto$2f$dist$2f$crypto$2e$node$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].subtle.sign(o.name, i, r.encode(t));
    return btoa(String.fromCharCode(...new Uint8Array(n)));
}
;
var Ie = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["createMiddleware"])(async ()=>({})), M = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["createMiddlewareCreator"])({
    use: [
        Ie,
        (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["createMiddleware"])(async ()=>({}))
    ]
}), y = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["createEndpointCreator"])({
    use: [
        Ie
    ]
});
var Se = M({
    body: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
        csrfToken: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional()
    }).optional()
}, async (e)=>{
    if (e.request?.method !== "POST" || e.context.options.advanced?.disableCSRFCheck) return;
    let t = e.headers?.get("origin") || "";
    if (t) {
        let c = new URL(t).origin;
        if (e.context.trustedOrigins.includes(c)) return;
    }
    let r = e.body?.csrfToken;
    if (!r) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("UNAUTHORIZED", {
        message: "CSRF Token is required"
    });
    let o = await e.getSignedCookie(e.context.authCookies.csrfToken.name, e.context.secret), [i, n] = o?.split("!") || [
        null,
        null
    ];
    if (!r || !i || !n || i !== r) throw e.setCookie(e.context.authCookies.csrfToken.name, "", {
        maxAge: 0
    }), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("UNAUTHORIZED", {
        message: "Invalid CSRF Token"
    });
    let a = await ee(e.context.secret, i);
    if (n !== a) throw e.setCookie(e.context.authCookies.csrfToken.name, "", {
        maxAge: 0
    }), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("UNAUTHORIZED", {
        message: "Invalid CSRF Token"
    });
});
;
;
;
;
;
;
async function _e(e) {
    let t = await (0, __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$crypto__$5b$external$5d$__$28$oslo$2f$crypto$2c$__esm_import$29$__["sha256"])(typeof e == "string" ? new TextEncoder().encode(e) : e);
    return Buffer.from(t).toString("base64");
}
async function Ce(e, t) {
    let r = await (0, __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$crypto__$5b$external$5d$__$28$oslo$2f$crypto$2c$__esm_import$29$__["sha256"])(typeof e == "string" ? new TextEncoder().encode(e) : e), o = Buffer.from(t, "base64");
    return X(r, o);
}
;
async function Be(e) {
    let t = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$oauth2__$5b$external$5d$__$28$oslo$2f$oauth2$2c$__esm_import$29$__["generateState"])(), r = JSON.stringify({
        code: t,
        callbackURL: e
    }), o = await _e(r);
    return {
        raw: r,
        hash: o
    };
}
function ae(e) {
    return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
        code: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string(),
        callbackURL: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional(),
        currentURL: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional()
    }).safeParse(JSON.parse(e));
}
;
var O = class extends Error {
    constructor(t, r){
        super(t), this.name = "BetterAuthError", this.message = t, this.cause = r;
    }
}, De = class extends O {
    constructor(t){
        super(`The package "${t}" is required. Make sure it is installed.`, t);
    }
};
;
function Ne(e) {
    let r = (e.advanced?.useSecureCookies !== void 0 ? e.advanced?.useSecureCookies : e.baseURL !== void 0 ? !!e.baseURL.startsWith("https://") : __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$std$2d$env$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["isProduction"]) ? "__Secure-" : "", o = "better-auth", i = e.session?.expiresIn || new __TURBOPACK__imported__module__$5b$externals$5d2f$oslo__$5b$external$5d$__$28$oslo$2c$__esm_import$29$__["TimeSpan"](7, "d").seconds(), n = !!e.advanced?.crossSubDomainCookies?.enabled, a = n ? e.advanced?.crossSubDomainCookies?.domain || (e.baseURL ? new URL(e.baseURL).hostname : void 0) : void 0;
    if (n && !a) throw new O("baseURL is required when crossSubdomainCookies are enabled");
    let c = n ? "none" : "lax";
    return {
        sessionToken: {
            name: `${r}${o}.session_token`,
            options: {
                httpOnly: !0,
                sameSite: c,
                path: "/",
                secure: !!r,
                maxAge: i,
                ...n ? {
                    domain: a
                } : {}
            }
        },
        csrfToken: {
            name: `${r}${o}.csrf_token`,
            options: {
                httpOnly: !0,
                sameSite: c,
                path: "/",
                secure: !!r,
                maxAge: 60 * 60 * 24 * 7,
                ...n ? {
                    domain: a
                } : {}
            }
        },
        state: {
            name: `${r}${o}.state`,
            options: {
                httpOnly: !0,
                sameSite: c,
                path: "/",
                secure: !!r,
                maxAge: 60 * 15,
                ...n ? {
                    domain: a
                } : {}
            }
        },
        pkCodeVerifier: {
            name: `${r}${o}.pk_code_verifier`,
            options: {
                httpOnly: !0,
                sameSite: c,
                path: "/",
                secure: !!r,
                maxAge: 60 * 15,
                ...n ? {
                    domain: a
                } : {}
            }
        },
        dontRememberToken: {
            name: `${r}${o}.dont_remember`,
            options: {
                httpOnly: !0,
                sameSite: c,
                path: "/",
                secure: !!r,
                ...n ? {
                    domain: a
                } : {}
            }
        },
        nonce: {
            name: `${r}${o}.nonce`,
            options: {
                httpOnly: !0,
                sameSite: c,
                path: "/",
                secure: !!r,
                maxAge: 60 * 15,
                ...n ? {
                    domain: a
                } : {}
            }
        }
    };
}
function qe(e) {
    let r = (e.advanced?.useSecureCookies !== void 0 ? e.advanced?.useSecureCookies : e.baseURL?.startsWith("https://") || __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$std$2d$env$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["isProduction"]) ? "__Secure-" : "", o = "better-auth", i = e.advanced?.crossSubDomainCookies?.domain || (e.baseURL ? new URL(e.baseURL).hostname : void 0);
    function n(a, c) {
        let s = e.advanced?.crossSubDomainCookies?.enabled ? e.advanced.crossSubDomainCookies.additionalCookies?.includes(a) : void 0;
        return {
            name: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$std$2d$env$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["env"].NODE_ENV === "production" ? `${r}${o}.${a}` : `${o}.${a}`,
            options: {
                secure: !!r,
                sameSite: "lax",
                path: "/",
                maxAge: 60 * 15,
                ...c,
                ...s ? {
                    domain: i
                } : {}
            }
        };
    }
    return n;
}
async function _(e, t, r, o) {
    let i = e.context.authCookies.sessionToken.options;
    i.maxAge = r ? void 0 : e.context.sessionConfig.expiresIn, await e.setSignedCookie(e.context.authCookies.sessionToken.name, t, e.context.secret, {
        ...i,
        ...o
    }), r && await e.setSignedCookie(e.context.authCookies.dontRememberToken.name, "true", e.context.secret, e.context.authCookies.dontRememberToken.options);
}
function G(e) {
    e.setCookie(e.context.authCookies.sessionToken.name, "", {
        maxAge: 0
    }), e.setCookie(e.context.authCookies.dontRememberToken.name, "", {
        maxAge: 0
    });
}
function Po(e) {
    let t = new Map;
    return e.split(", ").forEach((o)=>{
        let [i, ...n] = o.split("; "), [a, c] = i.split("="), s = {
            value: c
        };
        n.forEach((d)=>{
            let [l, f] = d.split("=");
            s[l.toLowerCase()] = f || !0;
        }), t.set(a, s);
    }), t;
}
function So(e) {
    let t = e.split("; "), r = new Map;
    return t.forEach((o)=>{
        let [i, n] = o.split("=");
        r.set(i, n);
    }), r;
}
;
;
var V = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$consola$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__["createConsola"])({
    formatOptions: {
        date: !1,
        colors: !0,
        compact: !0
    },
    defaults: {
        tag: "Better Auth"
    }
}), de = (e)=>({
        log: (...t)=>{
            !e?.disabled && V.log("", ...t);
        },
        error: (...t)=>{
            !e?.disabled && V.error("", ...t);
        },
        warn: (...t)=>{
            !e?.disabled && V.warn("", ...t);
        },
        info: (...t)=>{
            !e?.disabled && V.info("", ...t);
        },
        debug: (...t)=>{
            !e?.disabled && V.debug("", ...t);
        },
        box: (...t)=>{
            !e?.disabled && V.box("", ...t);
        },
        success: (...t)=>{
            !e?.disabled && V.success("", ...t);
        },
        break: (...t)=>{
            !e?.disabled && console.log(`
`);
        }
    }), b = de();
var v = M(async (e)=>{
    let { body: t, query: r, headers: o, context: i } = e, n = t?.callbackURL || r?.callbackURL || r?.redirectTo || t?.redirectTo, a = r?.currentURL || o?.get("referer") || i.baseURL, c = i.trustedOrigins, s = (d, l)=>{
        if (d?.startsWith("http") && !c.some((p)=>d.startsWith(p))) throw b.error(`Invalid ${l}`, {
            [l]: d,
            trustedOrigins: c
        }), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("FORBIDDEN", {
            message: `Invalid ${l}`
        });
    };
    s(n, "callbackURL"), s(a, "currentURL");
});
;
;
;
async function Ve(e) {
    let t = await (0, __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$crypto__$5b$external$5d$__$28$oslo$2f$crypto$2c$__esm_import$29$__["sha256"])(new TextEncoder().encode(e));
    return __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$encoding__$5b$external$5d$__$28$oslo$2f$encoding$2c$__esm_import$29$__["base64url"].encode(new Uint8Array(t), {
        includePadding: !1
    });
}
function $e(e) {
    return {
        tokenType: e.token_type,
        accessToken: e.access_token,
        refreshToken: e.refresh_token,
        accessTokenExpiresAt: e.expires_at ? new Date((Date.now() + e.expires_in) * 1e3) : void 0,
        scopes: e?.scope ? typeof e.scope == "string" ? e.scope.split(" ") : e.scope : [],
        idToken: e.id_token
    };
}
async function k({ id: e, options: t, authorizationEndpoint: r, state: o, codeVerifier: i, scopes: n, claims: a, disablePkce: c, redirectURI: s }) {
    let d = new URL(r);
    if (d.searchParams.set("response_type", "code"), d.searchParams.set("client_id", t.clientId), d.searchParams.set("state", o), d.searchParams.set("scope", n.join(" ")), d.searchParams.set("redirect_uri", t.redirectURI || s), !c && i) {
        let l = await Ve(i);
        d.searchParams.set("code_challenge_method", "S256"), d.searchParams.set("code_challenge", l);
    }
    if (a) {
        let l = a.reduce((f, p)=>(f[p] = null, f), {});
        d.searchParams.set("claims", JSON.stringify({
            id_token: {
                email: null,
                email_verified: null,
                ...l
            }
        }));
    }
    return d;
}
;
async function A({ code: e, codeVerifier: t, redirectURI: r, options: o, tokenEndpoint: i }) {
    let n = new URLSearchParams;
    n.set("grant_type", "authorization_code"), n.set("code", e), t && n.set("code_verifier", t), n.set("redirect_uri", r), n.set("client_id", o.clientId), n.set("client_secret", o.clientSecret);
    let { data: a, error: c } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$better$2d$fetch$2f$fetch$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["betterFetch"])(i, {
        method: "POST",
        body: n,
        headers: {
            "content-type": "application/x-www-form-urlencoded",
            accept: "application/json",
            "user-agent": "better-auth"
        }
    });
    if (c) throw c;
    return $e(a);
}
function ce(e) {
    let t = e.accessToken, r = e.refreshToken, o;
    try {
        o = e.accessTokenExpiresAt;
    } catch  {}
    return {
        accessToken: t,
        refreshToken: r,
        expiresAt: o
    };
}
var ze = (e)=>{
    let t = "https://appleid.apple.com/auth/token";
    return {
        id: "apple",
        name: "Apple",
        createAuthorizationURL ({ state: r, scopes: o, redirectURI: i }) {
            let n = e.scope || o || [
                "email",
                "name",
                "openid"
            ];
            return new URL(`https://appleid.apple.com/auth/authorize?client_id=${e.clientId}&response_type=code&redirect_uri=${i || e.redirectURI}&scope=${n.join(" ")}&state=${r}`);
        },
        validateAuthorizationCode: async ({ code: r, codeVerifier: o, redirectURI: i })=>A({
                code: r,
                codeVerifier: o,
                redirectURI: e.redirectURI || i,
                options: e,
                tokenEndpoint: t
            }),
        async getUserInfo (r) {
            if (!r.idToken) return null;
            let o = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$jwt__$5b$external$5d$__$28$oslo$2f$jwt$2c$__esm_import$29$__["parseJWT"])(r.idToken)?.payload;
            return o ? {
                user: {
                    id: o.sub,
                    name: o.name,
                    email: o.email,
                    emailVerified: o.email_verified === "true"
                },
                data: o
            } : null;
        }
    };
};
;
var je = (e)=>({
        id: "discord",
        name: "Discord",
        createAuthorizationURL ({ state: t, scopes: r, redirectURI: o }) {
            let i = e.scope || r || [
                "identify",
                "email"
            ];
            return new URL(`https://discord.com/api/oauth2/authorize?scope=${i.join("+")}&response_type=code&client_id=${e.clientId}&redirect_uri=${encodeURIComponent(e.redirectURI || o)}&state=${t}`);
        },
        validateAuthorizationCode: async ({ code: t, redirectURI: r })=>A({
                code: t,
                redirectURI: e.redirectURI || r,
                options: e,
                tokenEndpoint: "https://discord.com/api/oauth2/token"
            }),
        async getUserInfo (t) {
            let { data: r, error: o } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$better$2d$fetch$2f$fetch$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["betterFetch"])("https://discord.com/api/users/@me", {
                headers: {
                    authorization: `Bearer ${t.accessToken}`
                }
            });
            if (o) return null;
            if (r.avatar === null) {
                let i = r.discriminator === "0" ? Number(BigInt(r.id) >> BigInt(22)) % 6 : parseInt(r.discriminator) % 5;
                r.image_url = `https://cdn.discordapp.com/embed/avatars/${i}.png`;
            } else {
                let i = r.avatar.startsWith("a_") ? "gif" : "png";
                r.image_url = `https://cdn.discordapp.com/avatars/${r.id}/${r.avatar}.${i}`;
            }
            return {
                user: {
                    id: r.id,
                    name: r.display_name || r.username || "",
                    email: r.email,
                    emailVerified: r.verified,
                    image: r.image_url
                },
                data: r
            };
        }
    });
;
var Me = (e)=>({
        id: "facebook",
        name: "Facebook",
        async createAuthorizationURL ({ state: t, scopes: r, redirectURI: o }) {
            let i = e.scope || r || [
                "email",
                "public_profile"
            ];
            return await k({
                id: "facebook",
                options: e,
                authorizationEndpoint: "https://www.facebook.com/v21.0/dialog/oauth",
                scopes: i,
                state: t,
                redirectURI: o
            });
        },
        validateAuthorizationCode: async ({ code: t, redirectURI: r })=>A({
                code: t,
                redirectURI: e.redirectURI || r,
                options: e,
                tokenEndpoint: "https://graph.facebook.com/oauth/access_token"
            }),
        async getUserInfo (t) {
            let { data: r, error: o } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$better$2d$fetch$2f$fetch$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["betterFetch"])("https://graph.facebook.com/me?fields=id,name,email,picture", {
                auth: {
                    type: "Bearer",
                    token: t.accessToken
                }
            });
            return o ? null : {
                user: {
                    id: r.id,
                    name: r.name,
                    email: r.email,
                    image: r.picture.data.url,
                    emailVerified: r.email_verified
                },
                data: r
            };
        }
    });
;
var Ke = (e)=>{
    let t = "https://github.com/login/oauth/access_token";
    return {
        id: "github",
        name: "GitHub",
        createAuthorizationURL ({ state: r, scopes: o, codeVerifier: i, redirectURI: n }) {
            let a = e.scope || o || [
                "user:email"
            ];
            return k({
                id: "github",
                options: e,
                authorizationEndpoint: "https://github.com/login/oauth/authorize",
                scopes: a,
                state: r,
                redirectURI: n,
                codeVerifier: i
            });
        },
        validateAuthorizationCode: async ({ code: r, redirectURI: o })=>A({
                code: r,
                redirectURI: e.redirectURI || o,
                options: e,
                tokenEndpoint: t
            }),
        async getUserInfo (r) {
            let { data: o, error: i } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$better$2d$fetch$2f$fetch$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["betterFetch"])("https://api.github.com/user", {
                headers: {
                    "User-Agent": "better-auth",
                    authorization: `Bearer ${r.accessToken}`
                }
            });
            if (i) return null;
            let n = !1;
            if (!o.email) {
                let { data: a, error: c } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$better$2d$fetch$2f$fetch$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["betterFetch"])("https://api.github.com/user/emails", {
                    headers: {
                        authorization: `Bearer ${r.accessToken}`,
                        "User-Agent": "better-auth"
                    }
                });
                c || (o.email = (a.find((s)=>s.primary) ?? a[0])?.email, n = a.find((s)=>s.email === o.email)?.verified ?? !1);
            }
            return {
                user: {
                    id: o.id.toString(),
                    name: o.name || o.login,
                    email: o.email,
                    image: o.avatar_url,
                    emailVerified: n
                },
                data: o
            };
        }
    };
};
;
var Ze = (e)=>({
        id: "google",
        name: "Google",
        createAuthorizationURL ({ state: t, scopes: r, codeVerifier: o, redirectURI: i }) {
            if (!e.clientId || !e.clientSecret) throw b.error("Client Id and Client Secret is required for Google. Make sure to provide them in the options."), new O("CLIENT_ID_AND_SECRET_REQUIRED");
            if (!o) throw new O("codeVerifier is required for Google");
            let n = e.scope || r || [
                "email",
                "profile"
            ];
            return k({
                id: "google",
                options: e,
                authorizationEndpoint: "https://accounts.google.com/o/oauth2/auth",
                scopes: n,
                state: t,
                codeVerifier: o,
                redirectURI: i
            });
        },
        validateAuthorizationCode: async ({ code: t, codeVerifier: r, redirectURI: o })=>A({
                code: t,
                codeVerifier: r,
                redirectURI: e.redirectURI || o,
                options: e,
                tokenEndpoint: "https://oauth2.googleapis.com/token"
            }),
        async getUserInfo (t) {
            if (!t.idToken) return null;
            let r = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$jwt__$5b$external$5d$__$28$oslo$2f$jwt$2c$__esm_import$29$__["parseJWT"])(t.idToken)?.payload;
            return {
                user: {
                    id: r.sub,
                    name: r.name,
                    email: r.email,
                    image: r.picture,
                    emailVerified: r.email_verified
                },
                data: r
            };
        }
    });
;
;
var Ge = (e)=>{
    let t = e.tenantId || "common", r = `https://login.microsoftonline.com/${t}/oauth2/v2.0/authorize`, o = `https://login.microsoftonline.com/${t}/oauth2/v2.0/token`;
    return {
        id: "microsoft",
        name: "Microsoft EntraID",
        createAuthorizationURL (i) {
            let n = e.scope || i.scopes || [
                "openid",
                "profile",
                "email",
                "User.Read"
            ];
            return k({
                id: "microsoft",
                options: e,
                authorizationEndpoint: r,
                state: i.state,
                codeVerifier: i.codeVerifier,
                scopes: n,
                redirectURI: i.redirectURI
            });
        },
        validateAuthorizationCode ({ code: i, codeVerifier: n, redirectURI: a }) {
            return A({
                code: i,
                codeVerifier: n,
                redirectURI: e.redirectURI || a,
                options: e,
                tokenEndpoint: o
            });
        },
        async getUserInfo (i) {
            if (!i.idToken) return null;
            let n = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$jwt__$5b$external$5d$__$28$oslo$2f$jwt$2c$__esm_import$29$__["parseJWT"])(i.idToken)?.payload, a = e.profilePhotoSize || 48;
            return await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$better$2d$fetch$2f$fetch$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["betterFetch"])(`https://graph.microsoft.com/v1.0/me/photos/${a}x${a}/$value`, {
                headers: {
                    Authorization: `Bearer ${i.accessToken}`
                },
                async onResponse (c) {
                    if (!(e.disableProfilePhoto || !c.response.ok)) try {
                        let d = await c.response.clone().arrayBuffer(), l = Buffer.from(d).toString("base64");
                        n.picture = `data:image/jpeg;base64, ${l}`;
                    } catch (s) {
                        b.error(s);
                    }
                }
            }), {
                user: {
                    id: n.sub,
                    name: n.name,
                    email: n.email,
                    image: n.picture,
                    emailVerified: !0
                },
                data: n
            };
        }
    };
};
;
var Qe = (e)=>({
        id: "spotify",
        name: "Spotify",
        createAuthorizationURL ({ state: t, scopes: r, codeVerifier: o, redirectURI: i }) {
            let n = e.scope || r || [
                "user-read-email"
            ];
            return k({
                id: "spotify",
                options: e,
                authorizationEndpoint: "https://accounts.spotify.com/authorize",
                scopes: n,
                state: t,
                codeVerifier: o,
                redirectURI: i
            });
        },
        validateAuthorizationCode: async ({ code: t, codeVerifier: r, redirectURI: o })=>A({
                code: t,
                codeVerifier: r,
                redirectURI: e.redirectURI || o,
                options: e,
                tokenEndpoint: "https://accounts.spotify.com/api/token"
            }),
        async getUserInfo (t) {
            let { data: r, error: o } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$better$2d$fetch$2f$fetch$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["betterFetch"])("https://api.spotify.com/v1/me", {
                method: "GET",
                headers: {
                    Authorization: `Bearer ${t.accessToken}`
                }
            });
            return o ? null : {
                user: {
                    id: r.id,
                    name: r.display_name,
                    email: r.email,
                    image: r.images[0]?.url,
                    emailVerified: !1
                },
                data: r
            };
        }
    });
;
function En(e) {
    return e.charAt(0).toUpperCase() + e.slice(1);
}
var N = {
    isAction: !1
};
;
var E = (e)=>(0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$nanoid$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__["nanoid"])(e);
;
var We = (e)=>({
        id: "twitch",
        name: "Twitch",
        createAuthorizationURL ({ state: t, scopes: r, redirectURI: o }) {
            let i = e.scope || r || [
                "user:read:email",
                "openid"
            ];
            return k({
                id: "twitch",
                redirectURI: o,
                options: e,
                authorizationEndpoint: "https://id.twitch.tv/oauth2/authorize",
                scopes: i,
                state: t,
                claims: e.claims || [
                    "email",
                    "email_verified",
                    "preferred_username",
                    "picture"
                ]
            });
        },
        validateAuthorizationCode: async ({ code: t, redirectURI: r })=>A({
                code: t,
                redirectURI: e.redirectURI || r,
                options: e,
                tokenEndpoint: "https://id.twitch.tv/oauth2/token"
            }),
        async getUserInfo (t) {
            let r = t.idToken;
            if (!r) return b.error("No idToken found in token"), null;
            let o = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$jwt__$5b$external$5d$__$28$oslo$2f$jwt$2c$__esm_import$29$__["parseJWT"])(r)?.payload;
            return {
                user: {
                    id: o.sub,
                    name: o.preferred_username,
                    email: o.email,
                    image: o.picture,
                    emailVerified: !1
                },
                data: o
            };
        }
    });
;
var Je = (e)=>({
        id: "twitter",
        name: "Twitter",
        createAuthorizationURL (t) {
            let r = e.scope || t.scopes || [
                "account_info.read"
            ];
            return k({
                id: "twitter",
                options: e,
                authorizationEndpoint: "https://twitter.com/i/oauth2/authorize",
                scopes: r,
                state: t.state,
                codeVerifier: t.codeVerifier,
                redirectURI: t.redirectURI
            });
        },
        validateAuthorizationCode: async ({ code: t, codeVerifier: r, redirectURI: o })=>A({
                code: t,
                codeVerifier: r,
                redirectURI: e.redirectURI || o,
                options: e,
                tokenEndpoint: "https://id.twitch.tv/oauth2/token"
            }),
        async getUserInfo (t) {
            let { data: r, error: o } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$better$2d$fetch$2f$fetch$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["betterFetch"])("https://api.x.com/2/users/me?user.fields=profile_image_url", {
                method: "GET",
                headers: {
                    Authorization: `Bearer ${t.accessToken}`
                }
            });
            return o || !r.data.email ? null : {
                user: {
                    id: r.data.id,
                    name: r.data.name,
                    email: r.data.email,
                    image: r.data.profile_image_url,
                    emailVerified: r.data.verified || !1
                },
                data: r
            };
        }
    });
;
var Ye = (e)=>{
    let t = "https://api.dropboxapi.com/oauth2/token";
    return {
        id: "dropbox",
        name: "Dropbox",
        createAuthorizationURL: async ({ state: r, scopes: o, codeVerifier: i, redirectURI: n })=>{
            let a = e.scope || o || [
                "account_info.read"
            ];
            return await k({
                id: "dropbox",
                options: e,
                authorizationEndpoint: "https://www.dropbox.com/oauth2/authorize",
                scopes: a,
                state: r,
                redirectURI: n,
                codeVerifier: i
            });
        },
        validateAuthorizationCode: async ({ code: r, codeVerifier: o, redirectURI: i })=>await A({
                code: r,
                codeVerifier: o,
                redirectURI: e.redirectURI || i,
                options: e,
                tokenEndpoint: t
            }),
        async getUserInfo (r) {
            let { data: o, error: i } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$better$2d$fetch$2f$fetch$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["betterFetch"])("https://api.dropboxapi.com/2/users/get_current_account", {
                method: "POST",
                headers: {
                    Authorization: `Bearer ${r.accessToken}`
                }
            });
            return i ? null : {
                user: {
                    id: o.account_id,
                    name: o.name?.display_name,
                    email: o.email,
                    emailVerified: o.email_verified || !1,
                    image: o.profile_photo_url
                },
                data: o
            };
        }
    };
};
;
var Xe = (e)=>{
    let t = "https://www.linkedin.com/oauth/v2/authorization", r = "https://www.linkedin.com/oauth/v2/accessToken";
    return {
        id: "linkedin",
        name: "Linkedin",
        createAuthorizationURL: async ({ state: o, scopes: i, redirectURI: n })=>{
            let a = e.scope || i || [
                "profile",
                "email",
                "openid"
            ];
            return await k({
                id: "linkedin",
                options: e,
                authorizationEndpoint: t,
                scopes: a,
                state: o,
                redirectURI: n
            });
        },
        validateAuthorizationCode: async ({ code: o, redirectURI: i })=>await A({
                code: o,
                redirectURI: e.redirectURI || i,
                options: e,
                tokenEndpoint: r
            }),
        async getUserInfo (o) {
            let { data: i, error: n } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$better$2d$fetch$2f$fetch$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["betterFetch"])("https://api.linkedin.com/v2/userinfo", {
                method: "GET",
                headers: {
                    Authorization: `Bearer ${o.accessToken}`
                }
            });
            return n ? null : {
                user: {
                    id: i.sub,
                    name: i.name,
                    email: i.email,
                    emailVerified: i.email_verified || !1,
                    image: i.picture
                },
                data: i
            };
        }
    };
};
var le = {
    apple: ze,
    discord: je,
    facebook: Me,
    github: Ke,
    microsoft: Ge,
    google: Ze,
    spotify: Qe,
    twitch: We,
    twitter: Je,
    dropbox: Ye,
    linkedin: Xe
}, et = Object.keys(le);
;
;
;
;
;
var $ = (e, t = "ms")=>new Date(Date.now() + (t === "sec" ? e * 1e3 : e));
;
var ue = ()=>y("/get-session", {
        method: "GET",
        requireHeaders: !0
    }, async (e)=>{
        try {
            let t = await e.getSignedCookie(e.context.authCookies.sessionToken.name, e.context.secret);
            if (!t) return e.json(null, {
                status: 401
            });
            let r = await e.context.internalAdapter.findSession(t);
            if (!r || r.session.expiresAt < new Date) return G(e), r && await e.context.internalAdapter.deleteSession(r.session.id), e.json(null, {
                status: 401
            });
            if (await e.getSignedCookie(e.context.authCookies.dontRememberToken.name, e.context.secret)) return e.json(r);
            let i = e.context.sessionConfig.expiresIn, n = e.context.sessionConfig.updateAge;
            if (r.session.expiresAt.valueOf() - i * 1e3 + n * 1e3 <= Date.now()) {
                let s = await e.context.internalAdapter.updateSession(r.session.id, {
                    expiresAt: $(e.context.sessionConfig.expiresIn, "sec")
                });
                if (!s) return G(e), e.json(null, {
                    status: 401
                });
                let d = (s.expiresAt.valueOf() - Date.now()) / 1e3;
                return await _(e, s.id, !1, {
                    maxAge: d
                }), e.json({
                    session: s,
                    user: r.user
                });
            }
            return e.json(r);
        } catch (t) {
            return e.context.logger.error(t), e.json(null, {
                status: 500
            });
        }
    }), pe = async (e)=>await ue()({
        ...e,
        _flag: "json",
        headers: e.headers
    }), C = M(async (e)=>{
    let t = await pe(e);
    if (!t?.session) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("UNAUTHORIZED");
    return {
        session: t
    };
}), rt = ()=>y("/user/list-sessions", {
        method: "GET",
        use: [
            C
        ],
        requireHeaders: !0
    }, async (e)=>{
        let r = (await e.context.internalAdapter.listSessions(e.context.session.user.id)).filter((o)=>o.expiresAt > new Date);
        return e.json(r);
    }), ot = y("/user/revoke-session", {
    method: "POST",
    body: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
        id: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string()
    }),
    use: [
        C
    ],
    requireHeaders: !0
}, async (e)=>{
    let t = e.body.id, r = await e.context.internalAdapter.findSession(t);
    if (!r) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "Session not found"
    });
    if (r.session.userId !== e.context.session.user.id) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("UNAUTHORIZED");
    try {
        await e.context.internalAdapter.deleteSession(t);
    } catch (o) {
        throw e.context.logger.error(o), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("INTERNAL_SERVER_ERROR");
    }
    return e.json({
        status: !0
    });
}), nt = y("/user/revoke-sessions", {
    method: "POST",
    use: [
        C
    ],
    requireHeaders: !0
}, async (e)=>{
    try {
        await e.context.internalAdapter.deleteSessions(e.context.session.user.id);
    } catch (t) {
        throw e.context.logger.error(t), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("INTERNAL_SERVER_ERROR");
    }
    return e.json({
        status: !0
    });
});
async function B(e, t, r) {
    return await (0, __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$jwt__$5b$external$5d$__$28$oslo$2f$jwt$2c$__esm_import$29$__["createJWT"])("HS256", Buffer.from(e), {
        email: t.toLowerCase(),
        updateTo: r
    }, {
        expiresIn: new __TURBOPACK__imported__module__$5b$externals$5d2f$oslo__$5b$external$5d$__$28$oslo$2c$__esm_import$29$__["TimeSpan"](1, "h"),
        issuer: "better-auth",
        subject: "verify-email",
        audiences: [
            t
        ],
        includeIssuedTimestamp: !0
    });
}
var it = y("/send-verification-email", {
    method: "POST",
    query: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
        currentURL: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional()
    }).optional(),
    body: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
        email: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().email(),
        callbackURL: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional()
    }),
    use: [
        v
    ]
}, async (e)=>{
    if (!e.context.options.emailVerification?.sendVerificationEmail) throw e.context.logger.error("Verification email isn't enabled."), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "Verification email isn't enabled"
    });
    let { email: t } = e.body, r = await e.context.internalAdapter.findUserByEmail(t);
    if (!r) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "User not found"
    });
    let o = await B(e.context.secret, t), i = `${e.context.baseURL}/verify-email?token=${o}&callbackURL=${e.body.callbackURL || e.query?.currentURL || "/"}`;
    return await e.context.options.emailVerification.sendVerificationEmail(r.user, i, o), e.json({
        status: !0
    });
}), st = y("/verify-email", {
    method: "GET",
    query: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
        token: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string(),
        callbackURL: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional()
    }),
    use: [
        v
    ]
}, async (e)=>{
    let { token: t } = e.query, r;
    try {
        r = await (0, __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$jwt__$5b$external$5d$__$28$oslo$2f$jwt$2c$__esm_import$29$__["validateJWT"])("HS256", Buffer.from(e.context.secret), t);
    } catch (a) {
        throw e.context.logger.error("Failed to verify email", a), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
            message: "Invalid token"
        });
    }
    let i = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
        email: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().email(),
        updateTo: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional()
    }).parse(r.payload);
    if (!await e.context.internalAdapter.findUserByEmail(i.email)) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "User not found"
    });
    if (i.updateTo) {
        let a = await pe(e);
        if (!a) throw e.query.callbackURL ? e.redirect(`${e.query.callbackURL}?error=unauthorized`) : new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("UNAUTHORIZED", {
            message: "Session not found"
        });
        if (a.user.email !== i.email) throw e.query.callbackURL ? e.redirect(`${e.query.callbackURL}?error=unauthorized`) : new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("UNAUTHORIZED", {
            message: "Invalid session"
        });
        let c = await e.context.internalAdapter.updateUserByEmail(i.email, {
            email: i.updateTo
        });
        if (await e.context.options.emailVerification?.sendVerificationEmail?.(c, `${e.context.baseURL}/verify-email?token=${t}`, t), e.query.callbackURL) throw e.redirect(e.query.callbackURL);
        return e.json({
            user: c,
            status: !0
        });
    }
    if (await e.context.internalAdapter.updateUserByEmail(i.email, {
        emailVerified: !0
    }), e.query.callbackURL) throw e.redirect(e.query.callbackURL);
    return e.json({
        user: null,
        status: !0
    });
});
var at = y("/sign-in/social", {
    method: "POST",
    requireHeaders: !0,
    query: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
        currentURL: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional()
    }).optional(),
    body: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
        callbackURL: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional(),
        provider: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].enum(et)
    }),
    use: [
        v
    ]
}, async (e)=>{
    let t = e.context.socialProviders.find((s)=>s.id === e.body.provider);
    if (!t) throw e.context.logger.error("Provider not found. Make sure to add the provider in your auth config", {
        provider: e.body.provider
    }), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("NOT_FOUND", {
        message: "Provider not found"
    });
    let r = e.context.authCookies, o = e.query?.currentURL ? new URL(e.query?.currentURL) : null, i = e.body.callbackURL?.startsWith("http") ? e.body.callbackURL : `${o?.origin}${e.body.callbackURL || ""}`, n = await Be(i || o?.origin || e.context.options.baseURL);
    await e.setSignedCookie(r.state.name, n.hash, e.context.secret, r.state.options);
    let a = (0, __TURBOPACK__imported__module__$5b$externals$5d2f$oslo$2f$oauth2__$5b$external$5d$__$28$oslo$2f$oauth2$2c$__esm_import$29$__["generateCodeVerifier"])();
    await e.setSignedCookie(r.pkCodeVerifier.name, a, e.context.secret, r.pkCodeVerifier.options);
    let c = await t.createAuthorizationURL({
        state: n.raw,
        codeVerifier: a,
        redirectURI: `${e.context.baseURL}/callback/${t.id}`
    });
    return e.json({
        url: c.toString(),
        state: n,
        codeVerifier: a,
        redirect: !0
    });
}), dt = y("/sign-in/email", {
    method: "POST",
    body: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
        email: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string(),
        password: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string(),
        callbackURL: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional(),
        dontRememberMe: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].boolean().default(!1).optional()
    }),
    use: [
        v
    ]
}, async (e)=>{
    if (!e.context.options?.emailAndPassword?.enabled) throw e.context.logger.error("Email and password is not enabled. Make sure to enable it in the options on you `auth.ts` file. Check `https://better-auth.com/docs/authentication/email-password` for more!"), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "Email and password is not enabled"
    });
    let { email: t, password: r } = e.body;
    if (!__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().email().safeParse(t).success) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "Invalid email"
    });
    if (!__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().email().safeParse(t).success) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "Invalid email"
    });
    let n = await e.context.internalAdapter.findUserByEmail(t, {
        includeAccounts: !0
    });
    if (!n) throw await e.context.password.hash(r), e.context.logger.error("User not found", {
        email: t
    }), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("UNAUTHORIZED", {
        message: "Invalid email or password"
    });
    let a = n.accounts.find((l)=>l.providerId === "credential");
    if (!a) throw e.context.logger.error("Credential account not found", {
        email: t
    }), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("UNAUTHORIZED", {
        message: "Invalid email or password"
    });
    let c = a?.password;
    if (!c) throw e.context.logger.error("Password not found", {
        email: t
    }), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("UNAUTHORIZED", {
        message: "Unexpected error"
    });
    if (!await e.context.password.verify(c, r)) throw e.context.logger.error("Invalid password"), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("UNAUTHORIZED", {
        message: "Invalid email or password"
    });
    if (e.context.options?.emailAndPassword?.requireEmailVerification && !n.user.emailVerified) {
        if (!e.context.options?.emailVerification?.sendVerificationEmail) throw b.error("Email verification is required but no email verification handler is provided"), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("INTERNAL_SERVER_ERROR", {
            message: "Email is not verified."
        });
        let l = await B(e.context.secret, n.user.email), f = `${e.context.options.baseURL}/verify-email?token=${l}`;
        throw await e.context.options.emailVerification.sendVerificationEmail(n.user, f, l), e.context.logger.error("Email not verified", {
            email: t
        }), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("FORBIDDEN", {
            message: "Email is not verified. Check your email for a verification link"
        });
    }
    let d = await e.context.internalAdapter.createSession(n.user.id, e.headers, e.body.dontRememberMe);
    if (!d) throw e.context.logger.error("Failed to create session"), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("UNAUTHORIZED", {
        message: "Failed to create session"
    });
    return await _(e, d.id, e.body.dontRememberMe), e.json({
        user: n.user,
        session: d,
        redirect: !!e.body.callbackURL,
        url: e.body.callbackURL
    });
});
;
;
var Wi = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
    id: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string(),
    providerId: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string(),
    accountId: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string(),
    userId: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string(),
    accessToken: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().nullable().optional(),
    refreshToken: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().nullable().optional(),
    idToken: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().nullable().optional(),
    expiresAt: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].date().nullable().optional(),
    password: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional().nullable()
}), ct = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
    id: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string(),
    email: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().transform((e)=>e.toLowerCase()),
    emailVerified: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].boolean().default(!1),
    name: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string(),
    image: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional(),
    createdAt: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].date().default(new Date),
    updatedAt: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].date().default(new Date)
}), Ji = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
    id: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string(),
    userId: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string(),
    expiresAt: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].date(),
    ipAddress: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional(),
    userAgent: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional()
}), Yi = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
    id: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string(),
    value: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string(),
    expiresAt: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].date(),
    identifier: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string()
});
function lt(e, t) {
    let r = {
        ...t === "user" ? e.user?.additionalFields : {},
        ...t === "session" ? e.session?.additionalFields : {}
    };
    for (let o of e.plugins || [])o.schema && o.schema[t] && (r = {
        ...r,
        ...o.schema[t].fields
    });
    return r;
}
function ut(e, t) {
    let r = t.fields, o = {};
    for(let i in r){
        if (i in e) {
            if (r[i].input === !1) {
                if (r[i].defaultValue) {
                    o[i] = r[i].defaultValue;
                    continue;
                }
                continue;
            }
            o[i] = e[i];
            continue;
        }
        if (r[i].defaultValue) {
            o[i] = r[i].defaultValue;
            continue;
        }
    }
    return o;
}
function pt(e, t) {
    let r = lt(e, "user");
    return ut(t || {}, {
        fields: r
    });
}
function ft(e, t) {
    let r = lt(e, "user");
    return ut(t || {}, {
        fields: r
    });
}
var mt = y("/callback/:id", {
    method: "GET",
    query: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
        state: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string(),
        code: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional(),
        error: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional()
    }),
    metadata: N
}, async (e)=>{
    if (e.query.error || !e.query.code) {
        let x = ae(e.query.state).data?.callbackURL || `${e.context.baseURL}/error`;
        throw e.context.logger.error(e.query.error, e.params.id), e.redirect(`${x}?error=${e.query.error || "oAuth_code_missing"}`);
    }
    let t = e.context.socialProviders.find((m)=>m.id === e.params.id);
    if (!t) throw e.context.logger.error("Oauth provider with id", e.params.id, "not found"), e.redirect(`${e.context.baseURL}/error?error=oauth_provider_not_found`);
    let r = ae(e.query.state);
    if (!r.success) throw e.context.logger.error("Unable to parse state"), e.redirect(`${e.context.baseURL}/error?error=please_restart_the_process`);
    let { data: { callbackURL: o, currentURL: i } } = r, n = await e.getSignedCookie(e.context.authCookies.state.name, e.context.secret);
    if (!n) throw b.error("No stored state found"), e.redirect(`${e.context.baseURL}/error?error=please_restart_the_process`);
    if (!await Ce(e.query.state, n)) throw b.error("OAuth state mismatch"), e.redirect(`${e.context.baseURL}/error?error=please_restart_the_process`);
    let c = await e.getSignedCookie(e.context.authCookies.pkCodeVerifier.name, e.context.secret), s;
    try {
        s = await t.validateAuthorizationCode({
            code: e.query.code,
            codeVerifier: c,
            redirectURI: `${e.context.baseURL}/callback/${t.id}`
        });
    } catch (m) {
        throw e.context.logger.error(m), e.redirect(`${e.context.baseURL}/error?error=please_restart_the_process`);
    }
    let d = await t.getUserInfo(s).then((m)=>m?.user), l = E(), f = ct.safeParse({
        ...d,
        id: l
    });
    if (!d || f.success === !1) throw b.error("Unable to get user info", f.error), e.redirect(`${e.context.baseURL}/error?error=please_restart_the_process`);
    if (!o) throw e.redirect(`${e.context.baseURL}/error?error=please_restart_the_process`);
    function p(m) {
        throw e.redirect(`${i || o || `${e.context.baseURL}/error`}?error=${m}`);
    }
    let u = await e.context.internalAdapter.findUserByEmail(d.email, {
        includeAccounts: !0
    }).catch((m)=>{
        throw b.error(`Better auth was unable to query your database.
Error: `, m), e.redirect(`${e.context.baseURL}/error?error=internal_server_error`);
    }), g = u?.user.id;
    if (u) {
        if (!u.accounts.find((x)=>x.providerId === t.id)) {
            (!e.context.options.account?.accountLinking?.trustedProviders?.includes(t.id) && !d.emailVerified || !e.context.options.account?.accountLinking?.enabled) && p("account_not_linked");
            try {
                await e.context.internalAdapter.linkAccount({
                    providerId: t.id,
                    accountId: d.id.toString(),
                    id: `${t.id}:${d.id}`,
                    userId: u.user.id,
                    ...ce(s)
                });
            } catch (q) {
                b.error("Unable to link account", q), p("unable_to_link_account");
            }
        }
    } else try {
        let m = d.emailVerified || !1, x = await e.context.internalAdapter.createOAuthUser({
            ...f.data,
            emailVerified: m
        }, {
            ...ce(s),
            providerId: t.id,
            accountId: d.id.toString()
        });
        if (g = x?.user.id, !m && x && e.context.options.emailVerification?.sendOnSignUp) {
            let Z = await B(e.context.secret, d.email), q = `${e.context.baseURL}/verify-email?token=${Z}&callbackURL=${o}`;
            await e.context.options.emailVerification?.sendVerificationEmail?.(x.user, q, Z);
        }
    } catch (m) {
        b.error("Unable to create user", m), p("unable_to_create_user");
    }
    g || p("unable_to_create_user");
    let h = await e.context.internalAdapter.createSession(g, e.request);
    throw h || p("unable_to_create_session"), await _(e, h.id), e.redirect(o);
});
;
;
var gt = y("/sign-out", {
    method: "POST"
}, async (e)=>{
    let t = await e.getSignedCookie(e.context.authCookies.sessionToken.name, e.context.secret);
    if (!t) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "Session not found"
    });
    return await e.context.internalAdapter.deleteSession(t), G(e), e.json({
        success: !0
    });
});
;
;
var ht = y("/forget-password", {
    method: "POST",
    body: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
        email: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().email(),
        redirectTo: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string()
    }),
    use: [
        v
    ]
}, async (e)=>{
    if (!e.context.options.emailAndPassword?.sendResetPassword) throw e.context.logger.error("Reset password isn't enabled.Please pass an emailAndPassword.sendResetPasswordToken function in your auth config!"), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "Reset password isn't enabled"
    });
    let { email: t, redirectTo: r } = e.body, o = await e.context.internalAdapter.findUserByEmail(t, {
        includeAccounts: !0
    });
    if (!o) return e.context.logger.error("Reset Password: User not found", {
        email: t
    }), e.json({
        status: !1
    }, {
        body: {
            status: !0
        }
    });
    let i = 60 * 60 * 1, n = new Date(Date.now() + 1e3 * (e.context.options.emailAndPassword.resetPasswordTokenExpiresIn || i)), a = e.context.uuid();
    await e.context.internalAdapter.createVerificationValue({
        value: o.user.id,
        identifier: `reset-password:${a}`,
        expiresAt: n
    });
    let c = `${e.context.baseURL}/reset-password/${a}?callbackURL=${r}`;
    return await e.context.options.emailAndPassword.sendResetPassword(o.user, c), e.json({
        status: !0
    });
}), yt = y("/reset-password/:token", {
    method: "GET",
    query: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
        callbackURL: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string()
    }),
    use: [
        v
    ]
}, async (e)=>{
    let { token: t } = e.params, r = e.query.callbackURL, o = r.startsWith("http") ? r : `${e.context.options.baseURL}${r}`;
    if (!t || !r) throw e.redirect(`${e.context.baseURL}/error?error=INVALID_TOKEN`);
    let i = await e.context.internalAdapter.findVerificationValue(`reset-password:${t}`);
    throw !i || i.expiresAt < new Date ? e.redirect(`${o}?error=INVALID_TOKEN`) : e.redirect(`${o}?token=${t}`);
}), wt = y("/reset-password", {
    query: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].optional(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
        token: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional(),
        currentURL: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional()
    })),
    method: "POST",
    body: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
        newPassword: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string()
    })
}, async (e)=>{
    let t = e.query?.token || (e.query?.currentURL ? new URL(e.query.currentURL).searchParams.get("token") : "");
    if (!t) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "Token not found"
    });
    let { newPassword: r } = e.body, o = `reset-password:${t}`, i = await e.context.internalAdapter.findVerificationValue(o);
    if (!i || i.expiresAt < new Date) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "Invalid token"
    });
    await e.context.internalAdapter.deleteVerificationValue(i.id);
    let n = i.value, a = await e.context.password.hash(r);
    if (!(await e.context.internalAdapter.findAccounts(n)).find((l)=>l.providerId === "credential")) return await e.context.internalAdapter.createAccount({
        userId: n,
        providerId: "credential",
        password: a,
        accountId: e.context.uuid()
    }), e.json({
        status: !0
    });
    if (!await e.context.internalAdapter.updatePassword(n, a)) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "Failed to update password"
    });
    return e.json({
        status: !0
    });
});
;
;
var bt = ()=>y("/user/update", {
        method: "POST",
        body: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].record(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string(), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].any()),
        use: [
            C,
            v
        ]
    }, async (e)=>{
        let t = e.body;
        if (t.email) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
            message: "You can't update email"
        });
        let { name: r, image: o, ...i } = t, n = e.context.session;
        if (!o && !r && Object.keys(i).length === 0) return e.json({
            user: n.user
        });
        let a = pt(e.context.options, i), c = await e.context.internalAdapter.updateUserByEmail(n.user.email, {
            name: r,
            image: o,
            ...a
        });
        return e.json({
            user: c
        });
    }), At = y("/user/change-password", {
    method: "POST",
    body: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
        newPassword: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string(),
        currentPassword: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string(),
        revokeOtherSessions: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].boolean().optional()
    }),
    use: [
        C
    ]
}, async (e)=>{
    let { newPassword: t, currentPassword: r, revokeOtherSessions: o } = e.body, i = e.context.session, n = e.context.password.config.minPasswordLength;
    if (t.length < n) throw e.context.logger.error("Password is too short"), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "Password is too short"
    });
    let a = e.context.password.config.maxPasswordLength;
    if (t.length > a) throw e.context.logger.error("Password is too long"), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "Password too long"
    });
    let s = (await e.context.internalAdapter.findAccounts(i.user.id)).find((f)=>f.providerId === "credential" && f.password);
    if (!s || !s.password) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "User does not have a password"
    });
    let d = await e.context.password.hash(t);
    if (!await e.context.password.verify(s.password, r)) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "Incorrect password"
    });
    if (await e.context.internalAdapter.updateAccount(s.id, {
        password: d
    }), o) {
        await e.context.internalAdapter.deleteSessions(i.user.id);
        let f = await e.context.internalAdapter.createSession(i.user.id, e.headers);
        if (!f) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("INTERNAL_SERVER_ERROR", {
            message: "Unable to create session"
        });
        await _(e, f.id);
    }
    return e.json(i.user);
}), kt = y("/user/set-password", {
    method: "POST",
    body: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
        newPassword: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string()
    }),
    use: [
        C
    ]
}, async (e)=>{
    let { newPassword: t } = e.body, r = e.context.session, o = e.context.password.config.minPasswordLength;
    if (t.length < o) throw e.context.logger.error("Password is too short"), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "Password is too short"
    });
    let i = e.context.password.config.maxPasswordLength;
    if (t.length > i) throw e.context.logger.error("Password is too long"), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "Password too long"
    });
    let a = (await e.context.internalAdapter.findAccounts(r.user.id)).find((s)=>s.providerId === "credential" && s.password), c = await e.context.password.hash(t);
    if (!a) return await e.context.internalAdapter.linkAccount({
        userId: r.user.id,
        providerId: "credential",
        accountId: r.user.id,
        password: c
    }), e.json(r.user);
    throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "user already has a password"
    });
}), Rt = y("/user/delete", {
    method: "POST",
    body: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
        password: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string()
    }),
    use: [
        C
    ]
}, async (e)=>{
    let { password: t } = e.body, r = e.context.session, i = (await e.context.internalAdapter.findAccounts(r.user.id)).find((c)=>c.providerId === "credential" && c.password);
    if (!i || !i.password) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "User does not have a password"
    });
    if (!await e.context.password.verify(i.password, t)) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "Incorrect password"
    });
    await e.context.internalAdapter.deleteUser(r.user.id), await e.context.internalAdapter.deleteSessions(r.user.id);
    let a = e.context.authCookies.sessionToken;
    return e.setCookie(a.name, "", {
        maxAge: 0
    }), e.json(null);
}), xt = y("/user/change-email", {
    method: "POST",
    query: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
        currentURL: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional()
    }).optional(),
    body: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
        newEmail: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().email(),
        callbackURL: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional()
    }),
    use: [
        C,
        v
    ]
}, async (e)=>{
    if (!e.context.options.user?.changeEmail?.enabled) throw e.context.logger.error("Change email is disabled."), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "Change email is disabled"
    });
    if (e.body.newEmail === e.context.session.user.email) throw e.context.logger.error("Email is the same"), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "Email is the same"
    });
    if (await e.context.internalAdapter.findUserByEmail(e.body.newEmail)) throw e.context.logger.error("Email already exists"), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "Couldn't update your email"
    });
    if (e.context.session.user.emailVerified !== !0) {
        let i = await e.context.internalAdapter.updateUserByEmail(e.context.session.user.email, {
            email: e.body.newEmail
        });
        return e.json({
            user: i,
            status: !0
        });
    }
    if (!e.context.options.user.changeEmail.sendChangeEmailVerification) throw e.context.logger.error("Verification email isn't enabled."), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
        message: "Verification email isn't enabled"
    });
    let r = await B(e.context.secret, e.context.session.user.email, e.body.newEmail), o = `${e.context.baseURL}/verify-email?token=${r}&callbackURL=${e.body.callbackURL || e.query?.currentURL || "/"}`;
    return await e.context.options.user.changeEmail.sendChangeEmailVerification(e.context.session.user, e.body.newEmail, o, r), e.json({
        user: null,
        status: !0
    });
});
var Ut = y("/csrf", {
    method: "GET",
    metadata: N
}, async (e)=>{
    let t = await e.getSignedCookie(e.context.authCookies.csrfToken.name, e.context.secret);
    if (t) {
        let [n, a] = t.split("!") || [
            null,
            null
        ];
        return e.json({
            csrfToken: n
        });
    }
    let r = Te(32, ve("a-z", "0-9", "A-Z")), o = await ee(e.context.secret, r), i = `${r}!${o}`;
    return await e.setSignedCookie(e.context.authCookies.csrfToken.name, i, e.context.secret, e.context.authCookies.csrfToken.options), e.json({
        csrfToken: r
    });
});
var Rr = (e = "Unknown")=>`<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Authentication Error</title>
    <style>
        :root {
            --bg-color: #f8f9fa;
            --text-color: #212529;
            --accent-color: #000000;
            --error-color: #dc3545;
            --border-color: #e9ecef;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            line-height: 1.5;
        }
        .error-container {
            background-color: #ffffff;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            padding: 2.5rem;
            text-align: center;
            max-width: 90%;
            width: 400px;
        }
        h1 {
            color: var(--error-color);
            font-size: 1.75rem;
            margin-bottom: 1rem;
            font-weight: 600;
        }
        p {
            margin-bottom: 1.5rem;
            color: #495057;
        }
        .btn {
            background-color: var(--accent-color);
            color: #ffffff;
            text-decoration: none;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            transition: all 0.3s ease;
            display: inline-block;
            font-weight: 500;
            border: 2px solid var(--accent-color);
        }
        .btn:hover {
            background-color: #131721;
        }
        .error-code {
            font-size: 0.875rem;
            color: #6c757d;
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--border-color);
        }
        .icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <div class="error-container">
        <div class="icon">\u26A0\uFE0F</div>
        <h1>Better Auth Error</h1>
        <p>We encountered an issue while processing your request. Please try again or contact the application owner if the problem persists.</p>
        <a href="/" id="returnLink" class="btn">Return to Application</a>
        <div class="error-code">Error Code: <span id="errorCode">${e}</span></div>
    </div>
</body>
</html>`, Tt = y("/error", {
    method: "GET",
    metadata: N
}, async (e)=>{
    let t = new URL(e.request?.url || "").searchParams.get("error") || "Unknown";
    return new Response(Rr(t), {
        headers: {
            "Content-Type": "text/html"
        }
    });
});
var vt = y("/ok", {
    method: "GET",
    metadata: N
}, async (e)=>e.json({
        ok: !0
    }));
;
;
var Et = ()=>y("/sign-up/email", {
        method: "POST",
        query: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].object({
            currentURL: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().optional()
        }).optional(),
        body: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].record(__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string(), __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].any()),
        use: [
            v
        ]
    }, async (e)=>{
        if (!e.context.options.emailAndPassword?.enabled) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
            message: "Email and password sign up is not enabled"
        });
        let t = e.body, { name: r, email: o, password: i, image: n, callbackURL: a, ...c } = t;
        if (!__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$zod$2f$v3$2f$external$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$export__$2a$__as__z$3e$__["z"].string().email().safeParse(o).success) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
            message: "Invalid email"
        });
        let d = e.context.password.config.minPasswordLength;
        if (i.length < d) throw e.context.logger.error("Password is too short"), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
            message: "Password is too short"
        });
        let l = e.context.password.config.maxPasswordLength;
        if (i.length > l) throw e.context.logger.error("Password is too long"), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
            message: "Password is too long"
        });
        if ((await e.context.internalAdapter.findUserByEmail(o))?.user) throw e.context.logger.info(`Sign-up attempt for existing email: ${o}`), new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("UNPROCESSABLE_ENTITY", {
            message: "User with this email already exists"
        });
        let p = ft(e.context.options, c), u;
        try {
            if (u = await e.context.internalAdapter.createUser({
                email: o.toLowerCase(),
                name: r,
                image: n,
                ...p,
                emailVerified: !1
            }), !u) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
                message: "Failed to create user"
            });
        } catch (m) {
            throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("UNPROCESSABLE_ENTITY", {
                message: "Failed to create user",
                details: m
            });
        }
        if (!u) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("UNPROCESSABLE_ENTITY", {
            message: "Failed to create user"
        });
        let g = await e.context.password.hash(i);
        if (await e.context.internalAdapter.linkAccount({
            userId: u.id,
            providerId: "credential",
            accountId: u.id,
            password: g,
            expiresAt: $(60 * 60 * 24 * 30, "sec")
        }), e.context.options.emailVerification?.sendOnSignUp) {
            let m = await B(e.context.secret, u.email), x = `${e.context.baseURL}/verify-email?token=${m}&callbackURL=${t.callbackURL || e.query?.currentURL || "/"}`;
            await e.context.options.emailVerification?.sendVerificationEmail?.(u, x, m);
        }
        if (!e.context.options.emailAndPassword.autoSignIn || e.context.options.emailAndPassword.requireEmailVerification) return e.json({
            user: u,
            session: null
        }, {
            body: t.callbackURL ? {
                url: t.callbackURL,
                redirect: !0
            } : {
                user: u,
                session: null
            }
        });
        let h = await e.context.internalAdapter.createSession(u.id, e.request);
        if (!h) throw new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]("BAD_REQUEST", {
            message: "Failed to create session"
        });
        return await _(e, h.id), e.json({
            user: u,
            session: h
        }, {
            body: t.callbackURL ? {
                url: t.callbackURL,
                redirect: !0
            } : {
                user: u,
                session: h
            }
        });
    });
;
function ne(e) {
    let t = "127.0.0.1";
    if (__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$std$2d$env$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["isTest"]) return t;
    let r = [
        "x-client-ip",
        "x-forwarded-for",
        "cf-connecting-ip",
        "fastly-client-ip",
        "x-real-ip",
        "x-cluster-client-ip",
        "x-forwarded",
        "forwarded-for",
        "forwarded"
    ], o = e instanceof Request ? e.headers : e;
    for (let i of r){
        let n = o.get(i);
        if (typeof n == "string") {
            let a = n.split(",")[0].trim();
            if (a) return a;
        }
    }
    return null;
}
function Ur(e, t, r) {
    let o = Date.now(), i = t * 1e3;
    return o - r.lastRequest < i && r.count >= e;
}
function Tr(e) {
    return new Response(JSON.stringify({
        message: "Too many requests. Please try again later."
    }), {
        status: 429,
        statusText: "Too Many Requests",
        headers: {
            "X-Retry-After": e.toString()
        }
    });
}
function vr(e, t) {
    let r = Date.now(), o = t * 1e3;
    return Math.ceil((e + o - r) / 1e3);
}
function Er(e, t) {
    let r = t ?? "rateLimit", o = e.adapter;
    return {
        get: async (i)=>await o.findOne({
                model: r,
                where: [
                    {
                        field: "key",
                        value: i
                    }
                ]
            }),
        set: async (i, n, a)=>{
            try {
                a ? await o.update({
                    model: t ?? "rateLimit",
                    where: [
                        {
                            field: "key",
                            value: i
                        }
                    ],
                    update: {
                        count: n.count,
                        lastRequest: n.lastRequest
                    }
                }) : await o.create({
                    model: t ?? "rateLimit",
                    data: {
                        key: i,
                        count: n.count,
                        lastRequest: n.lastRequest
                    }
                });
            } catch (c) {
                b.error("Error setting rate limit", c);
            }
        }
    };
}
var Ot = new Map;
function Or(e) {
    return e.rateLimit.storage === "secondary-storage" ? {
        get: async (r)=>{
            let o = await e.options.secondaryStorage?.get(r);
            return o ? JSON.parse(o) : void 0;
        },
        set: async (r, o)=>{
            await e.options.secondaryStorage?.set?.(r, JSON.stringify(o));
        }
    } : e.rateLimit.storage === "memory" ? {
        async get (r) {
            return Ot.get(r);
        },
        async set (r, o, i) {
            Ot.set(r, o);
        }
    } : Er(e, e.rateLimit.tableName);
}
async function It(e, t) {
    if (!t.rateLimit.enabled) return;
    let r = t.baseURL, o = e.url.replace(r, ""), i = t.rateLimit.window, n = t.rateLimit.max, a = ne(e) + o, s = Ir().find((p)=>p.pathMatcher(o));
    s && (i = s.window, n = s.max);
    for (let p of t.options.plugins || [])if (p.rateLimit) {
        let u = p.rateLimit.find((g)=>g.pathMatcher(o));
        if (u) {
            i = u.window, n = u.max;
            break;
        }
    }
    if (t.rateLimit.customRules) {
        let p = t.rateLimit.customRules[o];
        p && (i = p.window, n = p.max);
    }
    let d = Or(t), l = await d.get(a), f = Date.now();
    if (!l) await d.set(a, {
        key: a,
        count: 1,
        lastRequest: f
    });
    else {
        let p = f - l.lastRequest;
        if (Ur(n, i, l)) {
            let u = vr(l.lastRequest, i);
            return Tr(u);
        } else p > i * 1e3 ? await d.set(a, {
            ...l,
            count: 1,
            lastRequest: f
        }) : await d.set(a, {
            ...l,
            count: l.count + 1,
            lastRequest: f
        });
    }
}
function Ir() {
    return [
        {
            pathMatcher (t) {
                return t.startsWith("/sign-in") || t.startsWith("/sign-up");
            },
            window: 10,
            max: 3
        }
    ];
}
;
function fe(e, t) {
    let r = t.plugins?.reduce((c, s)=>({
            ...c,
            ...s.endpoints
        }), {}), o = t.plugins?.map((c)=>c.middlewares?.map((s)=>{
            let d = async (l)=>s.middleware({
                    ...l,
                    context: {
                        ...e,
                        ...l.context
                    }
                });
            return d.path = s.path, d.options = s.middleware.options, d.headers = s.middleware.headers, {
                path: s.path,
                middleware: d
            };
        })).filter((c)=>c !== void 0).flat() || [], n = {
        ...{
            signInOAuth: at,
            callbackOAuth: mt,
            getCSRFToken: Ut,
            getSession: ue(),
            signOut: gt,
            signUpEmail: Et(),
            signInEmail: dt,
            forgetPassword: ht,
            resetPassword: wt,
            verifyEmail: st,
            sendVerificationEmail: it,
            changeEmail: xt,
            changePassword: At,
            setPassword: kt,
            updateUser: bt(),
            deleteUser: Rt,
            forgetPasswordCallback: yt,
            listSessions: rt(),
            revokeSession: ot,
            revokeSessions: nt
        },
        ...r,
        ok: vt,
        error: Tt
    }, a = {};
    for (let [c, s] of Object.entries(n))a[c] = async (d = {})=>{
        let l = await e;
        for (let u of t.plugins || [])if (u.hooks?.before) {
            for (let g of u.hooks.before)if (g.matcher({
                ...s,
                ...d,
                context: l
            })) {
                let m = await g.handler({
                    ...d,
                    context: {
                        ...l,
                        ...d?.context
                    }
                });
                m && "context" in m && (l = {
                    ...l,
                    ...m.context
                });
            }
        }
        let f;
        try {
            f = await s({
                ...d,
                context: {
                    ...l,
                    ...d.context
                }
            });
        } catch (u) {
            if (u instanceof __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"]) {
                let g = t.plugins?.map((m)=>{
                    if (m.hooks?.after) return m.hooks.after;
                }).filter((m)=>m !== void 0).flat();
                if (!g?.length) throw u;
                let h = new Response(JSON.stringify(u.body), {
                    status: __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["statusCode"][u.status],
                    headers: u.headers
                });
                for (let m of g || [])if (m.matcher(d)) {
                    let Z = Object.assign(d, {
                        context: {
                            ...e,
                            returned: h
                        }
                    }), q = await m.handler(Z);
                    q && "response" in q && (h = q.response);
                }
                return h;
            }
            throw u;
        }
        let p = f;
        for (let u of t.plugins || [])if (u.hooks?.after) {
            for (let g of u.hooks.after)if (g.matcher(d)) {
                let m = Object.assign(d, {
                    context: {
                        ...e,
                        returned: p
                    }
                }), x = await g.handler(m);
                x && "response" in x && (p = x.response);
            }
        }
        return p;
    }, a[c].path = s.path, a[c].method = s.method, a[c].options = s.options, a[c].headers = s.headers;
    return {
        api: a,
        middlewares: o
    };
}
var St = (e, t)=>{
    let { api: r, middlewares: o } = fe(e, t), i = new URL(e.baseURL).pathname;
    return (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["createRouter"])(r, {
        extraContext: e,
        basePath: i,
        routerMiddleware: [
            {
                path: "/**",
                middleware: Se
            },
            ...o
        ],
        async onRequest (n) {
            for (let a of e.options.plugins || [])if (a.onRequest) {
                let c = await a.onRequest(n, e);
                if (c) return c;
            }
            return It(n, e);
        },
        async onResponse (n) {
            for (let a of e.options.plugins || [])if (a.onResponse) {
                let c = await a.onResponse(n, e);
                if (c) return c.response;
            }
            return n;
        },
        onError (n) {
            if (t.onAPIError?.throw) throw n;
            if (t.onAPIError?.onError) {
                t.onAPIError.onError(n, e);
                return;
            }
            let a = t.logger?.verboseLogging ? b : void 0;
            t.logger?.disabled !== !0 && (n instanceof __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$better$2d$call$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["APIError"] ? (n.status === "INTERNAL_SERVER_ERROR" && b.error(n), a?.error(n.message)) : b?.error(n));
        }
    });
};
var F = (e)=>{
    let t = e.plugins?.reduce((s, d)=>{
        let l = d.schema;
        if (!l) return s;
        for (let [f, p] of Object.entries(l))s[f] = {
            fields: {
                ...s[f]?.fields,
                ...p.fields
            },
            tableName: p.tableName || f
        };
        return s;
    }, {}), r = e.rateLimit?.storage === "database", o = {
        rateLimit: {
            tableName: e.rateLimit?.tableName || "rateLimit",
            fields: {
                key: {
                    type: "string",
                    fieldName: e.rateLimit?.fields?.key || "key"
                },
                count: {
                    type: "number",
                    fieldName: e.rateLimit?.fields?.count || "count"
                },
                lastRequest: {
                    type: "number",
                    fieldName: e.rateLimit?.fields?.lastRequest || "lastRequest"
                }
            }
        }
    }, { user: i, session: n, account: a, ...c } = t || {};
    return {
        user: {
            tableName: e.user?.modelName || "user",
            fields: {
                name: {
                    type: "string",
                    required: !0,
                    fieldName: e.user?.fields?.name || "name"
                },
                email: {
                    type: "string",
                    unique: !0,
                    required: !0,
                    fieldName: e.user?.fields?.email || "email"
                },
                emailVerified: {
                    type: "boolean",
                    defaultValue: ()=>!1,
                    required: !0,
                    fieldName: e.user?.fields?.emailVerified || "emailVerified"
                },
                image: {
                    type: "string",
                    required: !1,
                    fieldName: e.user?.fields?.image || "image"
                },
                createdAt: {
                    type: "date",
                    defaultValue: ()=>new Date,
                    required: !0,
                    fieldName: e.user?.fields?.createdAt || "createdAt"
                },
                updatedAt: {
                    type: "date",
                    defaultValue: ()=>new Date,
                    required: !0,
                    fieldName: e.user?.fields?.updatedAt || "updatedAt"
                },
                ...i?.fields,
                ...e.user?.additionalFields
            },
            order: 1
        },
        session: {
            tableName: e.session?.modelName || "session",
            fields: {
                expiresAt: {
                    type: "date",
                    required: !0,
                    fieldName: e.session?.fields?.expiresAt || "expiresAt"
                },
                ipAddress: {
                    type: "string",
                    required: !1,
                    fieldName: e.session?.fields?.ipAddress || "ipAddress"
                },
                userAgent: {
                    type: "string",
                    required: !1,
                    fieldName: e.session?.fields?.userAgent || "userAgent"
                },
                userId: {
                    type: "string",
                    fieldName: e.session?.fields?.userId || "userId",
                    references: {
                        model: e.user?.modelName || "user",
                        field: "id",
                        onDelete: "cascade"
                    },
                    required: !0
                },
                ...n?.fields,
                ...e.session?.additionalFields
            },
            order: 2
        },
        account: {
            tableName: e.account?.modelName || "account",
            fields: {
                accountId: {
                    type: "string",
                    required: !0,
                    fieldName: e.account?.fields?.accountId || "accountId"
                },
                providerId: {
                    type: "string",
                    required: !0,
                    fieldName: e.account?.fields?.providerId || "providerId"
                },
                userId: {
                    type: "string",
                    references: {
                        model: e.user?.modelName || "user",
                        field: "id",
                        onDelete: "cascade"
                    },
                    required: !0,
                    fieldName: e.account?.fields?.userId || "userId"
                },
                accessToken: {
                    type: "string",
                    required: !1,
                    fieldName: e.account?.fields?.accessToken || "accessToken"
                },
                refreshToken: {
                    type: "string",
                    required: !1,
                    fieldName: e.account?.fields?.refreshToken || "refreshToken"
                },
                idToken: {
                    type: "string",
                    required: !1,
                    fieldName: e.account?.fields?.idToken || "idToken"
                },
                expiresAt: {
                    type: "date",
                    required: !1,
                    fieldName: e.account?.fields?.expiresAt || "expiresAt"
                },
                password: {
                    type: "string",
                    required: !1,
                    fieldName: e.account?.fields?.password || "password"
                },
                ...a?.fields
            },
            order: 3
        },
        verification: {
            tableName: e.verification?.modelName || "verification",
            fields: {
                identifier: {
                    type: "string",
                    required: !0,
                    fieldName: e.verification?.fields?.identifier || "identifier"
                },
                value: {
                    type: "string",
                    required: !0,
                    fieldName: e.verification?.fields?.value || "value"
                },
                expiresAt: {
                    type: "date",
                    required: !0,
                    fieldName: e.verification?.fields?.expiresAt || "expiresAt"
                }
            },
            order: 4
        },
        ...c,
        ...r ? o : {}
    };
};
;
;
function Dt(e) {
    if ("dialect" in e) return Dt(e.dialect);
    if ("createDriver" in e) {
        if (e instanceof __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$kysely$2f$dist$2f$esm$2f$dialect$2f$sqlite$2f$sqlite$2d$dialect$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["SqliteDialect"]) return "sqlite";
        if (e instanceof __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$kysely$2f$dist$2f$esm$2f$dialect$2f$mysql$2f$mysql$2d$dialect$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["MysqlDialect"]) return "mysql";
        if (e instanceof __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$kysely$2f$dist$2f$esm$2f$dialect$2f$postgres$2f$postgres$2d$dialect$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["PostgresDialect"]) return "postgres";
        if (e instanceof __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$kysely$2f$dist$2f$esm$2f$dialect$2f$mssql$2f$mssql$2d$dialect$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["MssqlDialect"]) return "mssql";
    }
    return "aggregate" in e ? "sqlite" : "getConnection" in e ? "mysql" : "connect" in e ? "postgres" : null;
}
var W = async (e)=>{
    let t = e.database;
    if ("db" in t) return {
        kysely: t.db,
        databaseType: t.type
    };
    if ("dialect" in t) return {
        kysely: new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$kysely$2f$dist$2f$esm$2f$kysely$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["Kysely"]({
            dialect: t.dialect
        }),
        databaseType: t.type
    };
    let r, o = Dt(t);
    return "createDriver" in t && (r = t), "aggregate" in t && (r = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$kysely$2f$dist$2f$esm$2f$dialect$2f$sqlite$2f$sqlite$2d$dialect$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["SqliteDialect"]({
        database: t
    })), "getConnection" in t && (r = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$kysely$2f$dist$2f$esm$2f$dialect$2f$mysql$2f$mysql$2d$dialect$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["MysqlDialect"]({
        pool: t
    })), "connect" in t && (r = new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$kysely$2f$dist$2f$esm$2f$dialect$2f$postgres$2f$postgres$2d$dialect$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["PostgresDialect"]({
        pool: t
    })), {
        kysely: r ? new __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$kysely$2f$dist$2f$esm$2f$kysely$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["Kysely"]({
            dialect: r
        }) : null,
        databaseType: o
    };
};
function J(e) {
    if (!e) return {
        and: null,
        or: null
    };
    let t = {
        and: [],
        or: []
    };
    return e.forEach((r)=>{
        let { field: o, value: i, operator: n = "=", connector: a = "AND" } = r, c = (s)=>n.toLowerCase() === "in" ? s(o, "in", Array.isArray(i) ? i : [
                i
            ]) : n === "contains" ? s(o, "like", `%${i}%`) : n === "starts_with" ? s(o, "like", `${i}%`) : n === "ends_with" ? s(o, "like", `%${i}`) : s(o, n, i);
        a === "OR" ? t.or.push(c) : t.and.push(c);
    }), {
        and: t.and.length ? t.and : null,
        or: t.or.length ? t.or : null
    };
}
function ie(e, t, r) {
    for(let o in e){
        let i = t[o] || Object.values(t).find((n)=>n.fieldName === o);
        e[o] === 0 && i.type === "boolean" && r?.boolean && (e[o] = !1), e[o] === 1 && i?.type === "boolean" && r?.boolean && (e[o] = !0), i?.type === "date" && (e[o] instanceof Date || (e[o] = new Date(e[o])));
    }
    return e;
}
function Ft(e, t) {
    for(let r in e)typeof e[r] == "boolean" && t?.boolean && (e[r] = e[r] ? 1 : 0), e[r] instanceof Date && (e[r] = e[r].toISOString());
    return e;
}
var Nt = (e, t)=>({
        id: "kysely",
        async create (r) {
            let { model: o, data: i, select: n } = r;
            t?.transform && (i = Ft(i, t.transform)), t?.generateId !== void 0 && (i.id = t.generateId ? t.generateId() : void 0);
            let a = await e.insertInto(o).values(i).returningAll().executeTakeFirst();
            if (t?.transform) {
                let c = t.transform.schema[o];
                a = c ? ie(i, c, t.transform) : a;
            }
            return n?.length && (a = a ? n.reduce((s, d)=>a?.[d] ? {
                    ...s,
                    [d]: a[d]
                } : s, {}) : null), a;
        },
        async findOne (r) {
            let { model: o, where: i, select: n } = r, { and: a, or: c } = J(i), s = e.selectFrom(o).selectAll();
            a && (s = s.where((l)=>l.and(a.map((f)=>f(l))))), c && (s = s.where((l)=>l.or(c.map((f)=>f(l)))));
            let d = await s.executeTakeFirst();
            if (n?.length && (d = d ? n.reduce((f, p)=>d?.[p] ? {
                    ...f,
                    [p]: d[p]
                } : f, {}) : null), t?.transform) {
                let l = t.transform.schema[o];
                return d = d && l ? ie(d, l, t.transform) : d, d || null;
            }
            return d || null;
        },
        async findMany (r) {
            let { model: o, where: i, limit: n, offset: a, sortBy: c } = r, s = e.selectFrom(o), { and: d, or: l } = J(i);
            d && (s = s.where((p)=>p.and(d.map((u)=>u(p))))), l && (s = s.where((p)=>p.or(l.map((u)=>u(p))))), s = s.limit(n || 100), a && (s = s.offset(a)), c && (s = s.orderBy(c.field, c.direction));
            let f = await s.selectAll().execute();
            if (t?.transform) {
                let p = t.transform.schema[o];
                return p ? f.map((u)=>ie(u, p, t.transform)) : f;
            }
            return f;
        },
        async update (r) {
            let { model: o, where: i, update: n } = r, { and: a, or: c } = J(i);
            t?.transform && (n = Ft(n, t.transform)), n.id && (n.id = void 0);
            let s = e.updateTable(o).set(n);
            a && (s = s.where((l)=>l.and(a.map((f)=>f(l))))), c && (s = s.where((l)=>l.or(c.map((f)=>f(l)))));
            let d = await s.returningAll().executeTakeFirst() || null;
            if (t?.transform) {
                let l = t.transform.schema[o];
                return l ? ie(d, l, t.transform) : d;
            }
            return d;
        },
        async delete (r) {
            let { model: o, where: i } = r, { and: n, or: a } = J(i), c = e.deleteFrom(o);
            n && (c = c.where((s)=>s.and(n.map((d)=>d(s))))), a && (c = c.where((s)=>s.or(a.map((d)=>d(s))))), await c.execute();
        },
        async deleteMany (r) {
            let { model: o, where: i } = r, { and: n, or: a } = J(i), c = e.deleteFrom(o);
            n && (c = c.where((s)=>s.and(n.map((d)=>d(s))))), a && (c = c.where((s)=>s.or(a.map((d)=>d(s))))), await c.execute();
        }
    });
async function qt(e) {
    if (!e.database) throw new O("Database configuration is required");
    if ("create" in e.database) return e.database;
    let { kysely: t, databaseType: r } = await W(e);
    if (!t) throw new O("Failed to initialize database adapter");
    let o = F(e), i = {};
    for (let n of Object.values(o))i[n.tableName] = n.fields;
    return Nt(t, {
        transform: {
            schema: i,
            date: !0,
            boolean: r === "sqlite"
        },
        generateId: "generateId" in e.database ? e.database.generateId : void 0
    });
}
function me(e, t) {
    let r = {
        id: t.id
    };
    for(let o in e){
        let i = e[o], n = t[o];
        r[i.fieldName || o] = n;
    }
    return r;
}
function T(e, t) {
    if (!t) return null;
    let r = {
        id: t.id
    };
    for (let [o, i] of Object.entries(e))r[o] = t[i.fieldName || o];
    return r;
}
function Vt(e, t) {
    let r = t.hooks, o = F(t.options);
    async function i(a, c, s) {
        let d = a, l = o[c];
        for (let u of r || []){
            let g = u[c]?.create?.before;
            if (g) {
                let h = await g(a);
                if (h === !1) return null;
                typeof h == "object" && "data" in h && (d = h.data);
            }
        }
        let f = s ? await s.fn(d) : null, p = !s || s.executeMainFn ? await e.create({
            model: l.tableName,
            data: {
                ...me(l.fields, d),
                id: d.id || E()
            }
        }) : f;
        for (let u of r || []){
            let g = u[c]?.create?.after;
            g && await g(p);
        }
        return T(l.fields, p);
    }
    async function n(a, c, s, d) {
        let l = a;
        for (let u of r || []){
            let g = u[s]?.update?.before;
            if (g) {
                let h = await g(a);
                if (h === !1) return null;
                l = typeof h == "object" ? h.data : h;
            }
        }
        let f = d ? await d.fn(l) : null, p = !d || d.executeMainFn ? await e.update({
            model: o[s].tableName,
            update: me(o[s].fields, l),
            where: c
        }) : f;
        for (let u of r || []){
            let g = u[s]?.update?.after;
            g && await g(p);
        }
        return T(o[s].fields, p);
    }
    return {
        createWithHooks: i,
        updateWithHooks: n
    };
}
var ge = (e, t)=>{
    let r = t.options, o = r.secondaryStorage, i = r.session?.expiresIn || 60 * 60 * 24 * 7, n = F(r), { createWithHooks: a, updateWithHooks: c } = Vt(e, t);
    return {
        createOAuthUser: async (s, d)=>{
            try {
                let l = await a({
                    id: E(),
                    createdAt: new Date,
                    updatedAt: new Date,
                    ...s
                }, "user"), f = await a({
                    id: E(),
                    ...d,
                    userId: l.id || s.id
                }, "account");
                return {
                    user: l,
                    account: f
                };
            } catch (l) {
                return console.log(l), null;
            }
        },
        createUser: async (s)=>await a({
                id: E(),
                createdAt: new Date,
                updatedAt: new Date,
                emailVerified: !1,
                ...s
            }, "user"),
        createAccount: async (s)=>await a({
                id: E(),
                createdAt: new Date,
                updatedAt: new Date,
                ...s
            }, "account"),
        listSessions: async (s)=>await e.findMany({
                model: n.session.tableName,
                where: [
                    {
                        field: n.session.fields.userId.fieldName || "userId",
                        value: s
                    }
                ]
            }),
        listUsers: async (s, d, l, f)=>(await e.findMany({
                model: n.user.tableName,
                limit: s,
                offset: d,
                sortBy: l,
                where: f
            })).map((u)=>T(n.user.fields, u)),
        deleteUser: async (s)=>{
            await e.delete({
                model: n.account.tableName,
                where: [
                    {
                        field: n.account.fields.userId.fieldName || "userId",
                        value: s
                    }
                ]
            }), await e.deleteMany({
                model: n.session.tableName,
                where: [
                    {
                        field: n.session.fields.userId.fieldName || "userId",
                        value: s
                    }
                ]
            }), await e.deleteMany({
                model: n.user.tableName,
                where: [
                    {
                        field: "id",
                        value: s
                    }
                ]
            });
        },
        createSession: async (s, d, l, f)=>{
            let p = d instanceof Request ? d.headers : d, u = {
                id: E(32),
                userId: s,
                expiresAt: l ? $(60 * 60 * 24, "sec") : $(i, "sec"),
                ipAddress: d && ne(d) || "",
                userAgent: p?.get("user-agent") || "",
                ...f
            };
            return await a(u, "session", o ? {
                fn: async (h)=>{
                    let m = await e.findOne({
                        model: n.user.tableName,
                        where: [
                            {
                                field: "id",
                                value: s
                            }
                        ]
                    });
                    return o.set(h.id, JSON.stringify({
                        session: h,
                        user: m
                    }), i), h;
                },
                executeMainFn: r.session?.storeSessionInDatabase
            } : void 0);
        },
        findSession: async (s)=>{
            if (o) {
                let p = await o.get(s);
                if (p) {
                    let u = JSON.parse(p);
                    return {
                        session: {
                            ...u.session,
                            expiresAt: new Date(u.session.expiresAt)
                        },
                        user: {
                            ...u.user,
                            createdAt: new Date(u.user.createdAt),
                            updatedAt: new Date(u.user.updatedAt)
                        }
                    };
                }
            }
            let d = await e.findOne({
                model: n.session.tableName,
                where: [
                    {
                        value: s,
                        field: "id"
                    }
                ]
            });
            if (!d) return null;
            let l = T(n.session.fields, d), f = await e.findOne({
                model: n.user.tableName,
                where: [
                    {
                        value: l.userId,
                        field: "id"
                    }
                ]
            });
            return f ? {
                session: l,
                user: T(n.user.fields, f)
            } : null;
        },
        findSessions: async (s)=>{
            if (o) {
                let p = [];
                for (let u of s){
                    let g = await o.get(u);
                    if (g) {
                        let h = JSON.parse(g), m = {
                            session: {
                                ...h.session,
                                expiresAt: new Date(h.session.expiresAt)
                            },
                            user: {
                                ...h.user,
                                createdAt: new Date(h.user.createdAt),
                                updatedAt: new Date(h.user.updatedAt)
                            }
                        };
                        p.push(m);
                    }
                }
                return p;
            }
            let d = await e.findMany({
                model: n.session.tableName,
                where: [
                    {
                        field: "id",
                        value: s,
                        operator: "in"
                    }
                ]
            }), l = d.map((p)=>T(n.session.fields, p).userId);
            if (!l.length) return [];
            let f = await e.findMany({
                model: n.user.tableName,
                where: [
                    {
                        field: "id",
                        value: l,
                        operator: "in"
                    }
                ]
            });
            return d.map((p)=>{
                let u = f.find((g)=>g.id === p.userId);
                return u ? {
                    session: T(n.session.fields, p),
                    user: T(n.user.fields, u)
                } : null;
            });
        },
        updateSession: async (s, d)=>await c(d, [
                {
                    field: "id",
                    value: s
                }
            ], "session", o ? {
                async fn (f) {
                    let p = await o.get(s), u = null;
                    if (p) {
                        let g = JSON.parse(p);
                        u = {
                            ...g.session,
                            ...f
                        }, await o.set(s, JSON.stringify({
                            session: u,
                            user: g.user
                        }), g.session.expiresAt ? new Date(g.session.expiresAt).getTime() : void 0);
                    } else return null;
                },
                executeMainFn: r.session?.storeSessionInDatabase
            } : void 0),
        deleteSession: async (s)=>{
            if (o) {
                await o.delete(s), r.session?.storeSessionInDatabase && await e.delete({
                    model: n.session.tableName,
                    where: [
                        {
                            field: "id",
                            value: s
                        }
                    ]
                });
                return;
            }
            await e.delete({
                model: n.session.tableName,
                where: [
                    {
                        field: "id",
                        value: s
                    }
                ]
            });
        },
        deleteSessions: async (s)=>{
            if (o) {
                let d = await e.findMany({
                    model: n.session.tableName,
                    where: [
                        {
                            field: n.session.fields.userId.fieldName || "userId",
                            value: s
                        }
                    ]
                });
                for (let l of d)await o.delete(l.id);
                r.session?.storeSessionInDatabase && await e.delete({
                    model: n.session.tableName,
                    where: [
                        {
                            field: n.session.fields.userId.fieldName || "userId",
                            value: s
                        }
                    ]
                });
                return;
            }
            await e.deleteMany({
                model: n.session.tableName,
                where: [
                    {
                        field: n.session.fields.userId.fieldName || "userId",
                        value: s
                    }
                ]
            });
        },
        findUserByEmail: async (s, d)=>{
            let l = await e.findOne({
                model: n.user.tableName,
                where: [
                    {
                        value: s.toLowerCase(),
                        field: n.user.fields.email.fieldName || "email"
                    }
                ]
            });
            if (!l) return null;
            if (d?.includeAccounts) {
                let f = await e.findMany({
                    model: n.account.tableName,
                    where: [
                        {
                            value: l.id,
                            field: n.account.fields.userId.fieldName || "userId"
                        }
                    ]
                });
                return {
                    user: T(n.user.fields, l),
                    accounts: f.map((p)=>T(n.account.fields, p))
                };
            }
            return {
                user: T(n.user.fields, l),
                accounts: []
            };
        },
        findUserById: async (s)=>await e.findOne({
                model: n.user.tableName,
                where: [
                    {
                        field: "id",
                        value: s
                    }
                ]
            }),
        linkAccount: async (s)=>await a({
                id: E(),
                ...s
            }, "account"),
        updateUser: async (s, d)=>await c(d, [
                {
                    field: "id",
                    value: s
                }
            ], "user"),
        updateUserByEmail: async (s, d)=>await c(d, [
                {
                    field: n.user.fields.email.fieldName || "email",
                    value: s
                }
            ], "user"),
        updatePassword: async (s, d)=>await c({
                password: d
            }, [
                {
                    field: n.account.fields.userId.fieldName || "userId",
                    value: s
                },
                {
                    field: n.account.fields.providerId.fieldName || "providerId",
                    value: "credential"
                }
            ], "account"),
        findAccounts: async (s)=>(await e.findMany({
                model: n.account.tableName,
                where: [
                    {
                        field: n.account.fields.userId.fieldName || "userId",
                        value: s
                    }
                ]
            })).map((l)=>T(n.account.fields, l)),
        updateAccount: async (s, d)=>await c(d, [
                {
                    field: "id",
                    value: s
                }
            ], "account"),
        createVerificationValue: async (s)=>await a({
                id: E(),
                ...s
            }, "verification"),
        findVerificationValue: async (s)=>{
            let d = await e.findOne({
                model: n.verification.tableName,
                where: [
                    {
                        field: n.verification.fields.identifier.fieldName || "identifier",
                        value: s
                    }
                ]
            });
            return T(n.verification.fields, d);
        },
        deleteVerificationValue: async (s)=>{
            await e.delete({
                model: n.verification.tableName,
                where: [
                    {
                        field: "id",
                        value: s
                    }
                ]
            });
        },
        updateVerificationValue: async (s, d)=>await c(d, [
                {
                    field: "id",
                    value: s
                }
            ], "verification")
    };
};
;
;
;
;
;
function _r(e) {
    try {
        return new URL(e).pathname !== "/";
    } catch  {
        throw new O(`Invalid base URL: ${e}. Please provide a valid base URL.`);
    }
}
function he(e, t = "/api/auth") {
    return _r(e) ? e : (t = t.startsWith("/") ? t : `/${t}`, `${e}${t}`);
}
function Y(e, t) {
    if (e) return he(e, t);
    let r = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$std$2d$env$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["env"].BETTER_AUTH_URL || __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$std$2d$env$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["env"].NEXT_PUBLIC_BETTER_AUTH_URL || __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$std$2d$env$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["env"].PUBLIC_BETTER_AUTH_URL || __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$std$2d$env$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["env"].NUXT_PUBLIC_BETTER_AUTH_URL || __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$std$2d$env$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["env"].NUXT_PUBLIC_AUTH_URL || (__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$std$2d$env$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["env"].BASE_URL !== "/" ? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$std$2d$env$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["env"].BASE_URL : void 0);
    if (r) return he(r, t);
    if (("TURBOPACK compile-time value", "undefined") < "u") return he(window.location.origin, t);
}
var ye = "better-auth-secret-123456789";
var zt = async (e)=>{
    let t = await qt(e), r = e.plugins || [], o = Dr(e), { kysely: i } = await W(e), n = Y(e.baseURL, e.basePath), a = e.secret || __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$std$2d$env$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["env"].BETTER_AUTH_SECRET || __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$std$2d$env$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["env"].AUTH_SECRET || ye;
    a === ye && __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$std$2d$env$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["isProduction"] && b.error("You are using the default secret. Please set `BETTER_AUTH_SECRET` in your environment variables or pass `secret` in your auth config."), e = {
        ...e,
        secret: a,
        baseURL: n ? new URL(n).origin : "",
        basePath: e.basePath || "/api/auth",
        plugins: r.concat(o),
        emailAndPassword: {
            ...e.emailAndPassword,
            enabled: e.emailAndPassword?.enabled ?? !1,
            autoSignIn: e.emailAndPassword?.autoSignIn ?? !0
        }
    };
    let c = Ne(e), s = F(e), d = Object.keys(e.socialProviders || {}).map((p)=>{
        let u = e.socialProviders?.[p];
        return u.enabled === !1 ? null : ((!u.clientId || !u.clientSecret) && b.warn(`Social provider ${p} is missing clientId or clientSecret`), le[p](u));
    }).filter((p)=>p !== null), l = {
        appName: e.appName || "Better Auth",
        socialProviders: d,
        options: e,
        tables: s,
        trustedOrigins: Fr(e),
        baseURL: n || "",
        sessionConfig: {
            updateAge: e.session?.updateAge || 24 * 60 * 60,
            expiresIn: e.session?.expiresIn || 60 * 60 * 24 * 7
        },
        secret: a,
        rateLimit: {
            ...e.rateLimit,
            enabled: e.rateLimit?.enabled ?? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$std$2d$env$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["isProduction"],
            window: e.rateLimit?.window || 10,
            max: e.rateLimit?.max || 100,
            storage: e.rateLimit?.storage || e.secondaryStorage ? "secondary-storage" : "memory"
        },
        authCookies: c,
        logger: de({
            disabled: e.logger?.disabled || !1
        }),
        db: i,
        uuid: E,
        secondaryStorage: e.secondaryStorage,
        password: {
            hash: e.emailAndPassword?.password?.hash || ke,
            verify: e.emailAndPassword?.password?.verify || Re,
            config: {
                minPasswordLength: e.emailAndPassword?.minPasswordLength || 8,
                maxPasswordLength: e.emailAndPassword?.maxPasswordLength || 128
            }
        },
        adapter: t,
        internalAdapter: ge(t, {
            options: e,
            hooks: e.databaseHooks ? [
                e.databaseHooks
            ] : []
        }),
        createAuthCookie: qe(e)
    }, { context: f } = Br(l);
    return f;
};
function Br(e) {
    let t = e.options, r = t.plugins || [], o = e, i = [];
    for (let n of r)if (n.init) {
        let a = n.init(e);
        typeof a == "object" && (a.options && (a.options.databaseHooks && i.push(a.options.databaseHooks), t = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$defu$2f$dist$2f$defu$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["defu"])(t, a.options)), a.context && (o = {
            ...o,
            ...a.context
        }));
    }
    return i.push(t.databaseHooks), o.internalAdapter = ge(e.adapter, {
        options: t,
        hooks: i.filter((n)=>n !== void 0)
    }), o.options = t, {
        context: o
    };
}
function Dr(e) {
    let t = [];
    return e.advanced?.crossSubDomainCookies?.enabled, t;
}
function Fr(e) {
    let t = Y(e.baseURL, e.basePath);
    if (!t) return [];
    let r = [
        new URL(t).origin
    ];
    e.trustedOrigins && r.push(...e.trustedOrigins);
    let o = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$std$2d$env$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["env"].BETTER_AUTH_TRUSTED_ORIGINS;
    return o && r.push(...o.split(",")), r;
}
var rc = (e)=>{
    let t = zt(e), { api: r } = fe(t, e);
    return {
        handler: async (o)=>{
            let i = await t, n = i.options.basePath || "/api/auth", a = new URL(o.url);
            if (!i.options.baseURL) {
                let s = Y(void 0, n) || `${a.origin}${n}`;
                i.options.baseURL = s, i.baseURL = s, i.trustedOrigins = [
                    a.origin
                ];
            }
            if (!i.options.baseURL) return new Response("Base URL not set", {
                status: 400
            });
            if (a.pathname === n || a.pathname === `${n}/`) return new Response("Welcome to BetterAuth", {
                status: 200
            });
            let { handler: c } = St(i, e);
            return c(o);
        },
        api: r,
        options: e,
        $Infer: {}
    };
};
;
__turbopack_async_result__();
} catch(e) { __turbopack_async_result__(e); } }, false);}),
"[project]/node_modules/better-auth/dist/next-js.js [app-route] (ecmascript)", ((__turbopack_context__) => {
"use strict";

__turbopack_context__.s([
    "authMiddleware",
    ()=>p,
    "toNextJsHandler",
    ()=>f
]);
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$better$2d$fetch$2f$fetch$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/@better-fetch/fetch/dist/index.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/server.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$std$2d$env$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/std-env/dist/index.mjs [app-route] (ecmascript)");
;
;
;
function f(e) {
    let s = async (r)=>"handler" in e ? e.handler(r) : e(r);
    return {
        GET: s,
        POST: s
    };
}
function p(e) {
    return async (s)=>{
        let r = __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$std$2d$env$2f$dist$2f$index$2e$mjs__$5b$app$2d$route$5d$__$28$ecmascript$29$__["env"].BETTER_AUTH_URL || new URL(s.url).origin, o = e?.basePath || "/api/auth", i = `${r}${o}/session`, t = (await (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$better$2d$fetch$2f$fetch$2f$dist$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["betterFetch"])(i, {
            headers: {
                cookie: s.headers.get("cookie") || ""
            }
        }).catch((d)=>({
                data: null
            }))).data || null;
        return e.customRedirect ? e.customRedirect(t, s) : t ? __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].next() : __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].redirect(new URL(e.redirectTo || "/", r));
    };
}
;
}),
];

//# sourceMappingURL=node_modules_better-auth_dist_5362377a._.js.map